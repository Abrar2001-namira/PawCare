
===== FILE: .htaccess =====
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php?url=$1 [QSA,L]


===== FILE: all_files.txt =====


===== FILE: config.php =====
<?php
define('BASE_URL', '/PawCare');


===== FILE: index.php =====
<?php
require_once 'config.php';
require_once 'core/Controller.php';
require_once 'core/Database.php';

$url = isset($_GET['url']) ? explode('/', $_GET['url']) : [];

$controllerName = !empty($url[0]) ? ucfirst($url[0]) . 'Controller' : 'UserController';
$method = isset($url[1]) ? $url[1] : 'register';

require_once 'app/controllers/' . $controllerName . '.php';
$controller = new $controllerName();
$controller->$method();


===== FILE: app\controllers\AdminAdoptionController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdminAdoptionController extends Controller
{
    private function guard() {
        if (($_SESSION['role'] ?? '') !== 'admin') {
            header("Location: ".BASE_URL."/User/login"); exit;
        }
    }

    public function index()
    {
        $this->guard();
        $apps = $this->model('Adoption')->all(); // includes pet info
        $this->view('admin/adoptions', ['apps'=>$apps]);
    }

    public function accept()
    {
        $this->guard();
        $id = $_GET['id'] ?? null;
        if(!$id){ header("Location: ".BASE_URL."/AdminAdoption/index"); exit; }

        $app = $this->model('Adoption')->find($id);
        if(!$app){ header("Location: ".BASE_URL."/AdminAdoption/index"); exit; }

        // 1) mark application accepted
        $this->model('Adoption')->setStatus($id, 'accepted');
        // 2) mark the pet as adopted
        $this->model('Pet')->setAdopted($app['pet_id'], 1);
        // 3) auto-reject all other pending apps for this pet
        $this->model('Adoption')->closeOthersForPet($app['pet_id'], $id);

        header("Location: ".BASE_URL."/AdminAdoption/index"); exit;
    }

    public function reject()
    {
        $this->guard();
        $id = $_GET['id'] ?? null;
        if(!$id){ header("Location: ".BASE_URL."/AdminAdoption/index"); exit; }

        $this->model('Adoption')->setStatus($id, 'rejected');
        header("Location: ".BASE_URL."/AdminAdoption/index"); exit;
    }
}


===== FILE: app\controllers\AdminController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdminController extends Controller
{
    /* --- admin-only gate --- */
    private function guard() {
        if (!isset($_SESSION['role']) || $_SESSION['role'] !== 'admin') {
            header("Location: " . BASE_URL . "/Shop/index"); exit;
        }
    }

    /* LIST */
    public function index() {
        $this->guard();
        $all = $this->model('Product')->all();
        $this->view('admin/index', ['products' => $all]);
    }

    /* ADD */
    public function add() {
        $this->guard();
        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            $this->model('Product')->create($_POST);
            header("Location: " . BASE_URL . "/Admin/index"); exit;
        }
        $this->view('admin/form', ['mode' => 'add']);
    }

    /* EDIT */
    public function edit() {
        $this->guard();
        /* id may come by GET (first load) or hidden POST (update) */
        $id = $_GET['id'] ?? ($_POST['id'] ?? null);
        if (!$id) { header("Location: " . BASE_URL . "/Admin/index"); exit; }

        $pModel = $this->model('Product');

        /* save update */
        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            $pModel->update($id, $_POST);
            header("Location: " . BASE_URL . "/Admin/index"); exit;
        }

        /* load edit form */
        $prod = $pModel->find($id);
        $this->view('admin/form', ['mode'=>'edit', 'prod'=>$prod]);
    }

    /* DELETE  (id by query) */
    public function delete() {
        $this->guard();
        $id = $_GET['id'] ?? null;
        if ($id) $this->model('Product')->delete($id);
        header("Location: " . BASE_URL . "/Admin/index"); exit;
    }
}


===== FILE: app\controllers\AdminDonationController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdminDonationController extends Controller
{
    private function guard()
    {
        if (($_SESSION['role'] ?? '') !== 'admin') {
            header("Location: ".BASE_URL."/Shop/index"); exit;
        }
    }

    public function index()
    {
        $this->guard();
        $list = $this->model('Donation')->all();   // joined with shelters
        $this->view('admin/donations', ['donations'=>$list]);
    }
}


===== FILE: app\controllers\AdminOrderController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdminOrderController extends Controller
{
    private function guard()
    {
        if (($_SESSION['role'] ?? '') !== 'admin') {
            header("Location: ".BASE_URL."/Shop/index"); exit;
        }
    }

    /* list all orders */
    public function index()
    {
        $this->guard();
        $orders = $this->model('Order')->all();
        $this->view('admin/orders', ['orders'=>$orders]);
    }

    /* mark delivered */
    public function deliver()
    {
        $this->guard();
        $id = $_GET['id'] ?? null;
        if ($id) $this->model('Order')->setDelivered($id);
        header("Location: ".BASE_URL."/AdminOrder/index");
    }
}


===== FILE: app\controllers\AdminPetController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdminPetController extends Controller
{
    /* --- admin-only gate --- */
    private function guard()
    {
        if (($_SESSION['role'] ?? '') !== 'admin') {
            header("Location: " . BASE_URL . "/Shop/index");
            exit;
        }
    }

    /* LIST */
    public function index()
    {
        $this->guard();
        $pets = $this->model('Pet')->all();
        $this->view('admin/pets', ['pets' => $pets]);
    }

    /* ADD */
    public function add()
    {
        $this->guard();
        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            $this->model('Pet')->create($_POST);
            header("Location: " . BASE_URL . "/AdminPet/index"); exit;
        }
        $this->view('admin/pet_form', ['mode' => 'add']);
    }

    /* EDIT */
    public function edit()
    {
        $this->guard();
        $id = $_GET['id'] ?? ($_POST['id'] ?? null);
        if (!$id) { header("Location: " . BASE_URL . "/AdminPet/index"); exit; }

        $pModel = $this->model('Pet');

        /* save update */
        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            $pModel->update($id, $_POST);
            header("Location: " . BASE_URL . "/AdminPet/index"); exit;
        }

        /* load edit form */
        $pet = $pModel->find($id);
        $this->view('admin/pet_form', ['mode'=>'edit', 'pet'=>$pet]);
    }

    /* DELETE */
    public function delete()
    {
        $this->guard();
        $id = $_GET['id'] ?? null;
        if ($id) $this->model('Pet')->delete($id);
        header("Location: " . BASE_URL . "/AdminPet/index"); exit;
    }
}


===== FILE: app\controllers\AdminRehomeController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdminRehomeController extends Controller
{
    private function guard() {
        if (($_SESSION['role'] ?? '') !== 'admin') {
            header("Location: ".BASE_URL."/User/login"); exit;
        }
    }

    public function index()
    {
        $this->guard();
        $list = $this->model('Rehome')->all();
        $this->view('admin/rehomes', ['list'=>$list]);
    }

    public function accept()
    {
        $this->guard();
        $id = $_GET['id'] ?? null; if(!$id){ header("Location: ".BASE_URL."/AdminRehome/index"); exit; }
        $req = $this->model('Rehome')->find($id); if(!$req){ header("Location: ".BASE_URL."/AdminRehome/index"); exit; }

        // Create a PET entry from request (available by default)
        $this->model('Pet')->create([
            'name'        => $req['name'],
            'species'     => $req['species'],
            'age'         => $req['age'],
            'breed'       => $req['breed'],
            'vaccinated'  => $req['vaccinated'],
            'adopted'     => 0,
            'image'       => $req['image'],
            'story'       => $req['story'],
            'phone'       => $req['owner_phone'],
            'email'       => $req['owner_email'],
            'location'    => $req['address']    // ⬅️ use Location
        ]);

        $this->model('Rehome')->setStatus($id,'accepted');
        echo "<script>alert('Request accepted. Pet added to list!');location='".BASE_URL."/AdminRehome/index';</script>";
        exit;
    }

    public function reject()
    {
        $this->guard();
        $id = $_GET['id'] ?? null; if(!$id){ header("Location: ".BASE_URL."/AdminRehome/index"); exit; }
        $this->model('Rehome')->setStatus($id,'rejected');
        header("Location: ".BASE_URL."/AdminRehome/index"); exit;
    }
}


===== FILE: app\controllers\AdoptionController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AdoptionController extends Controller
{
    /* Show guidelines + form for a specific pet */
    public function apply()
    {
        $petId = $_GET['pet_id'] ?? ($_POST['pet_id'] ?? null);
        if (!$petId) { header("Location: ".BASE_URL."/Pet/index"); exit; }

        $pet = $this->model('Pet')->find($petId);
        if (!$pet)  { header("Location: ".BASE_URL."/Pet/index"); exit; }

        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            /* basic validation */
            if (empty($_POST['applicant_name']) || empty($_POST['email']) || empty($_POST['phone']) || empty($_POST['city_state']) || empty($_POST['agree'])) {
                echo "<script>alert('Please fill the required fields and agree to the guidelines.');history.back();</script>";
                exit;
            }

            /* turn checkbox arrays into comma strings */
            $join = function($key) { return isset($_POST[$key]) ? implode(', ', (array)$_POST[$key]) : ''; };

            $data = [
                'user_id'        => $_SESSION['user_id'] ?? null,
                'pet_id'         => $petId,
                'applicant_name' => trim($_POST['applicant_name']),
                'email'          => trim($_POST['email']),
                'phone'          => trim($_POST['phone']),
                'city_state'     => trim($_POST['city_state']),
                'can_text'       => (int)($_POST['can_text'] ?? 0),
                'heard_about'    => $join('heard'),
                'current_pets'   => $join('current_pets'),
                'looking_for'    => $join('looking_for'),
                'house_type'     => $join('house_type'),
                'house_members'  => trim($_POST['house_members'] ?? ''),
                'notes'          => trim($_POST['notes'] ?? ''),
                'initials'       => trim($_POST['initials'] ?? ''),
                'agree'          => 1
            ];

            $id = $this->model('Adoption')->create($data);
            header("Location: ".BASE_URL."/Adoption/thanks?id=".$id); exit;
        }

        $this->view('adoption/apply', ['pet'=>$pet]);
    }

    /* Short confirmation */
    public function thanks()
    {
        $id = $_GET['id'] ?? null;
        if (!$id) { header("Location: ".BASE_URL."/Pet/index"); exit; }

        $a = $this->model('Adoption')->find($id);
        if (!$a) { header("Location: ".BASE_URL."/Pet/index"); exit; }

        $this->view('adoption/thanks', ['app'=>$a]);
    }
}


===== FILE: app\controllers\AppointmentController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class AppointmentController extends Controller
{
    /* Landing: find nearby vets by location */
    public function index()
    {
        $location = trim($_GET['location'] ?? '');
        $vets = $this->model('Vet')->search($location);
        $this->view('appointment/index', ['vets'=>$vets, 'location'=>$location]);
    }

    /* Book: GET=show slots, POST=save booking */
    public function book()
    {
        if (!isset($_GET['vet_id']) && !isset($_POST['vet_id'])) {
            header("Location: ".BASE_URL."/Appointment/index"); exit;
        }
        $vetId = (int)($_GET['vet_id'] ?? $_POST['vet_id']);
        $vet   = $this->model('Vet')->find($vetId);
        if (!$vet) { header("Location: ".BASE_URL."/Appointment/index"); exit; }

        // date to show (default today)
        $date = $_GET['date'] ?? $_POST['appt_date'] ?? date('Y-m-d');
        $date = date('Y-m-d', strtotime($date));

        // workday slots 9:00–17:00 hourly
        $slots = ['09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00'];
        $taken = $this->model('Appointment')->takenSlots($vetId, $date);

        if ($_SERVER['REQUEST_METHOD']==='POST') {
            if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }

            $petName = trim($_POST['pet_name'] ?? '');
            $slot    = $_POST['slot'] ?? '';
            $notes   = trim($_POST['notes'] ?? '');

            if ($petName==='' || !in_array($slot, $slots, true)) {
                echo "<script>alert('Please enter your pet name and select an available slot.');history.back();</script>"; exit;
            }
            if (in_array($slot, $taken, true)) {
                echo "<script>alert('Sorry, that slot was just taken. Please choose another.');history.back();</script>"; exit;
            }

            $id = $this->model('Appointment')->create([
                'user_id'   => $_SESSION['user_id'],
                'vet_id'    => $vetId,
                'pet_name'  => $petName,
                'appt_date' => $date,
                'slot'      => $slot,
                'notes'     => $notes,
                'status'    => 'booked'
            ]);
            header("Location: ".BASE_URL."/Appointment/thanks?id=".$id); exit;
        }

        $this->view('appointment/book', [
            'vet'=>$vet, 'date'=>$date, 'slots'=>$slots, 'taken'=>$taken
        ]);
    }

    /* Thank you */
    public function thanks()
    {
        $id = (int)($_GET['id'] ?? 0);
        if (!$id) { header("Location: ".BASE_URL."/Appointment/index"); exit; }
        $a = $this->model('Appointment')->find($id);
        if (!$a) { header("Location: ".BASE_URL."/Appointment/index"); exit; }
        $this->view('appointment/thanks', ['a'=>$a]);
    }

    /* User’s appointment history */
    public function history()
    {
        if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }
        $list = $this->model('Appointment')->byUser($_SESSION['user_id']);
        $this->view('appointment/history', ['list'=>$list]);
    }

    /* Cancel from profile/history — accepts POST (preferred) or GET fallback */
    public function cancel()
    {
        if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }

        // Prefer POST, but allow GET?id=... as a safe fallback so the button always works.
        $id = 0;
        if ($_SERVER['REQUEST_METHOD'] === 'POST') {
            $id = (int)($_POST['id'] ?? 0);
        } else {
            $id = (int)($_GET['id'] ?? 0);
        }

        if ($id > 0) {
            // Model verifies ownership (user_id) and only cancels booked ones.
            $this->model('Appointment')->cancel($id, $_SESSION['user_id']);
            // After status becomes 'cancelled', takenSlots() won’t include it, so the slot is free immediately.
        }

        // Send the user back where they came from, otherwise to profile.
        $back = $_SERVER['HTTP_REFERER'] ?? (BASE_URL.'/User/profile');
        header("Location: ".$back);
        exit;
    }
}


===== FILE: app\controllers\CartController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class CartController extends Controller
{
    public function add()
    {
        $id  = $_GET['id'] ?? null;
        $qty = max(1, (int)($_POST['qty'] ?? 1));
        if (!$id) header("Location: ".BASE_URL."/Shop/index");
        $_SESSION['cart'][$id] = ($_SESSION['cart'][$id] ?? 0) + $qty;
        header("Location: ".BASE_URL."/shop/index");
    }

    public function index()
    {
        [$items,$total] = $this->cartItems();
        $this->view('cart/index',['items'=>$items,'total'=>$total]);
    }

    public function remove()
    {
        $id = $_GET['id'] ?? null;
        unset($_SESSION['cart'][$id]);
        header("Location: ".BASE_URL."/Cart/index");
    }

    /*  Checkout: show form → save order */
    public function checkout()
    {
        [$items,$total] = $this->cartItems();
        if (!$items) { header("Location: ".BASE_URL."/Cart/index"); exit; }

        if ($_SERVER['REQUEST_METHOD']==='POST') {
            /* turn item list into easy-to-read text */
            $list = array_map(fn($i)=>$i['name'].' x'.$i['qty'],$items);
            $itemString = implode(', ', $list);

            $this->model('Order')->create([
    'user_id' => $_SESSION['user_id'] ?? null,   // ⭐ new
    'customer'=> $_POST['customer'],
    'address' => $_POST['address'],
    'contact' => $_POST['contact'],
    'items'   => $itemString,
    'total'   => $total
]);

            unset($_SESSION['cart']);
            echo "<script>alert('Order placed! Thank you.');location='".BASE_URL."/Shop/index';</script>";
            exit;
        }
        $this->view('cart/checkout',['items'=>$items,'total'=>$total]);
    }

    /* -------- helper -------- */
    private function cartItems()
    {
        $cart = $_SESSION['cart'] ?? [];
        $items=[]; $total=0;
        if ($cart) {
            $m = $this->model('Product');
            foreach ($cart as $pid=>$q) {
                if ($p=$m->find($pid)) {
                    $p['qty']=$q; $p['line']=$q*$p['price'];
                    $items[]=$p;   $total+=$p['line'];
                }
            }
        }
        return [$items,$total];
    }
}


===== FILE: app\controllers\DonationController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class DonationController extends Controller
{
    /* Landing page (hero + info + stats + Donate Now button) */
    public function index()
    {
        $stats = $this->model('Donation')->stats();
        $this->view('donation/index', [
            'stats'    => $stats
        ]);
    }

    /* Show the donation form */
    public function give()
    {
        $shelters = $this->model('Shelter')->all();
        $this->view('donation/give', [
            'shelters' => $shelters,
            'username' => $_SESSION['user'] ?? '',
            'email'    => ''   // prefill if you want later
        ]);
    }

    /* Handle submit */
    public function submit()
    {
        if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
            header("Location: ".BASE_URL."/Donation/give"); exit;
        }

        $amount    = (float)($_POST['amount'] ?? 0);
        $shelterId = $_POST['shelter_id'] ?? null;

        if ($amount <= 0 || !$shelterId) {
            echo "<script>alert('Please select a shelter and enter a valid amount.');history.back();</script>";
            exit;
        }

        $data = [
            'user_id'    => $_SESSION['user_id'] ?? null,
            'name'       => trim($_POST['name'] ?? ($_SESSION['user'] ?? '')),
            'email'      => trim($_POST['email'] ?? ''),
            'shelter_id' => $shelterId,
            'amount'     => $amount,
            'note'       => trim($_POST['note'] ?? '')
        ];

        $id = $this->model('Donation')->create($data);
        header("Location: ".BASE_URL."/Donation/thanks?id=".$id); exit;
    }

    /* Thank-you page */
    public function thanks()
    {
        $id = $_GET['id'] ?? null;
        if (!$id) { header("Location: ".BASE_URL."/Donation/index"); exit; }

        $don = $this->model('Donation')->find($id);
        if (!$don) { header("Location: ".BASE_URL."/Donation/index"); exit; }

        $this->view('donation/thanks', ['donation'=>$don]);
    }
}


===== FILE: app\controllers\OrderController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class OrderController extends Controller
{
    /* /Order/index → list current user’s orders */
    public function index()
    {
        if (!isset($_SESSION['user_id'])) {          // not logged-in
            header("Location: ".BASE_URL."/User/login"); exit;
        }

        $orders = $this->model('Order')->byUser($_SESSION['user_id']);
        $this->view('orders/index', ['orders'=>$orders]);
    }
}


===== FILE: app\controllers\PetController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';

class PetController extends Controller
{
    public function index()
    {
        $species  = $_GET['species']  ?? null;               // 'Dog', 'Cat', or null for All
        $location = trim($_GET['location'] ?? '');           // free text search

        $pets = $this->model('Pet')->search($species, $location);

        $this->view('pet/index', [
            'pets'     => $pets,
            'species'  => $species,
            'location' => $location
        ]);
    }

    public function detail()
    {
        $id = $_GET['id'] ?? null;
        if (!$id) { header("Location: " . BASE_URL . "/Pet/index"); exit; }

        $pet = $this->model('Pet')->find($id);
        if (!$pet) { header("Location: " . BASE_URL . "/Pet/index"); exit; }

        $this->view('pet/detail', ['pet' => $pet]);
    }
}


===== FILE: app\controllers\RehomeController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class RehomeController extends Controller
{
    private function guard() {
        if (!isset($_SESSION['user_id'])) {
            header("Location: ".BASE_URL."/User/login"); exit;
        }
    }

    /* GET: show form, POST: save request */
    public function request()
    {
        $this->guard();

        if ($_SERVER['REQUEST_METHOD']==='POST') {
            $data = [
                'user_id'    => $_SESSION['user_id'],
                'owner_name' => trim($_POST['owner_name'] ?? $_SESSION['user']),
                'owner_email'=> trim($_POST['owner_email'] ?? ''),
                'owner_phone'=> trim($_POST['owner_phone'] ?? ''),
                'address'    => trim($_POST['address'] ?? ''),
                'name'       => trim($_POST['name'] ?? ''),
                'species'    => trim($_POST['species'] ?? 'Dog'),
                'age'        => trim($_POST['age'] ?? ''),
                'breed'      => trim($_POST['breed'] ?? ''),
                'vaccinated' => (int)($_POST['vaccinated'] ?? 1),
                'image'      => trim($_POST['image'] ?? ''),
                'story'      => trim($_POST['story'] ?? '')
            ];

            // simple validations
            if ($data['name']==='' || $data['image']==='') {
                echo "<script>alert('Please provide pet name and a photo URL.');history.back();</script>"; exit;
            }

            $id = $this->model('Rehome')->create($data);
            header("Location: ".BASE_URL."/Rehome/thanks?id=".$id); exit;
        }

        // prefill from logged user (optional)
        $u = $this->model('User')->findById($_SESSION['user_id']);
        $this->view('rehome/request', ['u'=>$u]);
    }

    public function thanks()
    {
        $id = $_GET['id'] ?? null;
        if (!$id) { header("Location: ".BASE_URL."/User/profile"); exit; }
        $req = $this->model('Rehome')->find($id);
        if (!$req) { header("Location: ".BASE_URL."/User/profile"); exit; }
        $this->view('rehome/thanks', ['r'=>$req]);
    }
}


===== FILE: app\controllers\ShopController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';

class ShopController extends Controller
{
    /* grid: /Shop/index or /Shop/index?cat=Food */
    public function index()
    {
        $m   = $this->model('Product');
        $cat = $_GET['cat'] ?? null;

        $this->view('shop/index', [
            'products' => $cat ? $m->byCategory($cat) : $m->all(),
            'cat'      => $cat
        ]);
    }

    /* detail: /Shop/detail?id=7 */
    public function detail()
    {
        $id = $_GET['id'] ?? null;
        if (!$id) {                               // no id → go back
            header("Location: ".BASE_URL."/Shop/index"); exit;
        }

        $prod = $this->model('Product')->find($id);
        if (!$prod) {                             // id not found → back
            header("Location: ".BASE_URL."/Shop/index"); exit;
        }

        $this->view('shop/detail', ['prod'=>$prod]);
    }
}


===== FILE: app\controllers\UserController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class UserController extends Controller
{
    /* REGISTER */
    public function register()
    {
        if ($_SERVER['REQUEST_METHOD']==='POST') {
            $id = $this->model('User')->create([
                'username'=>$_POST['username'],
                'email'   =>$_POST['email'],
                'password'=>password_hash($_POST['password'],PASSWORD_DEFAULT),
                'role'    =>'user'
            ]);

            $_SESSION['user_id'] = $id;
            $_SESSION['user']    = $_POST['username'];
            $_SESSION['role']    = 'user';
            header("Location: ".BASE_URL."/User/welcome"); exit;
        }
        $this->view('user/register');
    }

    /* LOGIN */
    public function login()
    {
        if ($_SERVER['REQUEST_METHOD']==='POST') {
            $u = $this->model('User')->checkLogin($_POST['email']);
            if ($u && password_verify($_POST['password'],$u['password'])) {
                $_SESSION['user_id'] = $u['id'];
                $_SESSION['user']    = $u['username'];
                $_SESSION['role']    = $u['role'];
                $dest = $u['role']==='admin' ? "/Admin/index" : "/User/welcome";
                header("Location: ".BASE_URL.$dest); exit;
            }
            echo "<p style='color:red;text-align:center'>Invalid credentials</p>";
        }
        $this->view('user/login');
    }

    /* WELCOME */
    public function welcome()
    {
        if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }
        $this->view('user/welcome', ['user'=>$_SESSION['user']]);
    }

    /* READ-ONLY PROFILE (no edit form here) */
    public function profile()
    {
        if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }
        $u = $this->model('User')->findById($_SESSION['user_id']);
        $this->view('user/profile', ['u'=>$u]);
    }

    /* EDIT PROFILE (only shown when user clicks “Edit Profile”) */
    public function edit()
    {
        if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }

        $userModel = $this->model('User');

        if ($_SERVER['REQUEST_METHOD']==='POST') {
            $userModel->update($_SESSION['user_id'], [
                'username'=> trim($_POST['username'] ?? ''),
                'email'   => trim($_POST['email'] ?? ''),
                'phone'   => trim($_POST['phone'] ?? ''),
                'address' => trim($_POST['address'] ?? ''),
                'bio'     => trim($_POST['bio'] ?? '')
            ]);
            $_SESSION['user'] = $_POST['username'] ?? $_SESSION['user'];
            echo "<script>alert('Profile updated!');location='".BASE_URL."/User/profile';</script>";
            exit;
        }

        $u = $userModel->findById($_SESSION['user_id']);
        $this->view('user/edit', ['u'=>$u]);
    }

    /* LOGOUT */
    public function logout()
    {
        session_destroy();
        header("Location: ".BASE_URL."/User/login"); exit;
    }
}


===== FILE: app\controllers\VaccinationController.php =====
<?php
require_once 'core/Controller.php';
require_once 'config.php';
session_start();

class VaccinationController extends Controller
{
    private function guard() {
        if (!isset($_SESSION['user_id'])) { header("Location: ".BASE_URL."/User/login"); exit; }
    }

    /* List + Add form */
    public function index()
    {
        $this->guard();

        $m = $this->model('Vaccination');

        if ($_SERVER['REQUEST_METHOD']==='POST') {
            $pet    = trim($_POST['pet_name'] ?? '');
            $vac    = trim($_POST['vaccine']  ?? '');
            $dose   = trim($_POST['dose']     ?? '');
            $due    = trim($_POST['due_date'] ?? '');
            $notes  = trim($_POST['notes']    ?? '');

            if ($pet==='' || $vac==='' || $due==='') {
                echo "<script>alert('Please fill Pet Name, Vaccine and Due Date');history.back();</script>"; exit;
            }

            $m->create([
                'user_id'  => $_SESSION['user_id'],
                'pet_name' => $pet,
                'vaccine'  => $vac,
                'dose'     => $dose,
                'due_date' => date('Y-m-d', strtotime($due)),
                'notes'    => $notes
            ]);

            header("Location: ".BASE_URL."/Vaccination/index"); exit;
        }

        $list = $m->byUser($_SESSION['user_id']);
        $this->view('vaccination/index', ['list'=>$list]);
    }

    public function done()
    {
        $this->guard();
        $id = (int)($_GET['id'] ?? 0);
        if ($id) $this->model('Vaccination')->setStatus($id, $_SESSION['user_id'], 'done');
        header("Location: ".BASE_URL."/Vaccination/index"); exit;
    }

    public function schedule()
    {
        $this->guard();
        $id = (int)($_GET['id'] ?? 0);
        if ($id) $this->model('Vaccination')->setStatus($id, $_SESSION['user_id'], 'scheduled');
        header("Location: ".BASE_URL."/Vaccination/index"); exit;
    }

    public function delete()
    {
        $this->guard();
        $id = (int)($_GET['id'] ?? 0);
        if ($id) $this->model('Vaccination')->delete($id, $_SESSION['user_id']);
        header("Location: ".BASE_URL."/Vaccination/index"); exit;
    }
}


===== FILE: app\models\Adoption.php =====
<?php
require_once 'core/Database.php';

class Adoption extends Database
{
    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO adoptions
             (user_id, pet_id, applicant_name, email, phone, city_state,
              can_text, heard_about, current_pets, looking_for, house_type,
              house_members, notes, initials, agree, status, created)
             VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?, 'pending', NOW())"
        );
        $q->execute([
            $d['user_id'], $d['pet_id'], $d['applicant_name'], $d['email'], $d['phone'],
            $d['city_state'], $d['can_text'], $d['heard_about'], $d['current_pets'],
            $d['looking_for'], $d['house_type'], $d['house_members'], $d['notes'],
            $d['initials'], $d['agree']
        ]);
        return $this->pdo->lastInsertId();
    }

    public function find($id)
    {
        $q = $this->pdo->prepare(
            "SELECT a.*, p.name AS pet_name, p.image AS pet_image
               FROM adoptions a
               LEFT JOIN pets p ON p.id = a.pet_id
             WHERE a.id=?"
        );
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    /* Admin list with pet info */
    public function all()
    {
        return $this->pdo->query(
            "SELECT a.*, p.name AS pet_name, p.image AS pet_image
               FROM adoptions a
               LEFT JOIN pets p ON p.id = a.pet_id
             ORDER BY a.created DESC"
        )->fetchAll(PDO::FETCH_ASSOC);
    }

    public function setStatus($id, $status)
    {
        $q = $this->pdo->prepare("UPDATE adoptions SET status=? WHERE id=?");
        return $q->execute([$status, $id]);
    }

    /* Reject other pending applications for the same pet */
    public function closeOthersForPet($petId, $acceptedId)
    {
        $q = $this->pdo->prepare(
            "UPDATE adoptions SET status='rejected'
             WHERE pet_id=? AND id<>? AND status='pending'"
        );
        $q->execute([$petId, $acceptedId]);
    }
}


===== FILE: app\models\Appointment.php =====
<?php
require_once 'core/Database.php';

class Appointment extends Database
{
    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO appointments
             (user_id, vet_id, pet_name, appt_date, slot, notes, status, created)
             VALUES (?,?,?,?,?,?,?,NOW())"
        );
        $q->execute([
            $d['user_id'], $d['vet_id'], $d['pet_name'],
            $d['appt_date'], $d['slot'], $d['notes'], $d['status']
        ]);
        return $this->pdo->lastInsertId();
    }

    /* used by the booking page to disable busy times */
    public function takenSlots($vetId, $date)
    {
        $q = $this->pdo->prepare(
            "SELECT slot FROM appointments
              WHERE vet_id=? AND appt_date=? AND status IN ('booked','completed')"
        );
        $q->execute([$vetId,$date]);
        return array_column($q->fetchAll(PDO::FETCH_ASSOC), 'slot');
    }

    public function byUser($uid)
    {
        $q = $this->pdo->prepare(
            "SELECT a.*, v.name AS vet_name, v.city AS vet_city
               FROM appointments a
               JOIN vets v ON v.id=a.vet_id
              WHERE a.user_id=?
              ORDER BY a.appt_date DESC, STR_TO_DATE(a.slot,'%H:%i') DESC"
        );
        $q->execute([$uid]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    /* Upcoming (for quick list on profile) */
    public function upcomingByUser($uid, $limit = 5)
    {
        $sql =
        "SELECT a.*, v.name AS vet_name, v.city AS vet_city
           FROM appointments a
           JOIN vets v ON v.id=a.vet_id
          WHERE a.user_id=?
            AND (
              a.appt_date > CURDATE() OR
              (a.appt_date = CURDATE() AND STR_TO_DATE(a.slot,'%H:%i') >= CURTIME())
            )
          ORDER BY a.appt_date ASC, STR_TO_DATE(a.slot,'%H:%i') ASC
          LIMIT ".(int)$limit;

        $q = $this->pdo->prepare($sql);
        $q->execute([$uid]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    public function find($id)
    {
        $q = $this->pdo->prepare(
            "SELECT a.*, v.name AS vet_name, v.city AS vet_city, v.address AS vet_address
               FROM appointments a
               JOIN vets v ON v.id=a.vet_id
              WHERE a.id=?"
        );
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    /* NEW: cancel (owner only, only when booked) */
    public function cancel($id, $userId)
    {
        $q = $this->pdo->prepare(
            "UPDATE appointments
                SET status='cancelled'
              WHERE id=? AND user_id=? AND status='booked'"
        );
        $q->execute([$id, $userId]);
        return $q->rowCount() > 0;
    }
}


===== FILE: app\models\Donation.php =====
<?php
require_once 'core/Database.php';

class Donation extends Database
{
    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO donations (user_id,name,email,shelter_id,amount,note,created)
             VALUES (?,?,?,?,?,?,NOW())"
        );
        $q->execute([
            $d['user_id'], $d['name'], $d['email'],
            $d['shelter_id'], $d['amount'], $d['note']
        ]);
        return $this->pdo->lastInsertId();
    }

    public function stats()
    {
        $row = $this->pdo->query(
            "SELECT 
                COUNT(*) AS donations,
                IFNULL(SUM(amount),0) AS total,
                COUNT(DISTINCT COALESCE(NULLIF(email,''), CONCAT('u',user_id), CONCAT('a',id))) AS donors
             FROM donations"
        )->fetch(PDO::FETCH_ASSOC);

        return [
            'donations' => (int)($row['donations'] ?? 0),
            'total'     => (float)($row['total'] ?? 0),
            'donors'    => (int)($row['donors'] ?? 0),
        ];
    }

    public function find($id)
    {
        $q = $this->pdo->prepare(
            "SELECT d.*, s.name AS shelter_name
               FROM donations d
               LEFT JOIN shelters s ON s.id = d.shelter_id
             WHERE d.id=?"
        );
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    /* ⭐ Admin list */
    public function all()
    {
        return $this->pdo->query(
            "SELECT d.id, d.created, d.name, d.email, d.amount, d.note,
                    s.name AS shelter_name
               FROM donations d
               LEFT JOIN shelters s ON s.id = d.shelter_id
             ORDER BY d.created DESC"
        )->fetchAll(PDO::FETCH_ASSOC);
    }
}


===== FILE: app\models\Order.php =====
<?php
require_once 'core/Database.php';

class Order extends Database
{
    /* save a new order */
    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO orders (user_id,customer,address,contact,items,total,status)
             VALUES (?,?,?,?,?,?,'pending')"
        );
        $q->execute([
            $d['user_id'], $d['customer'], $d['address'],
            $d['contact'], $d['items'], $d['total']
        ]);
        return $this->pdo->lastInsertId();
    }

    /* fetch orders for one user */
    public function byUser($uid)
    {
        $q = $this->pdo->prepare(
            "SELECT * FROM orders WHERE user_id=? ORDER BY created DESC"
        );
        $q->execute([$uid]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    /* admin – fetch everyone’s orders */
    public function all()
    {
        return $this->pdo->query(
            "SELECT * FROM orders ORDER BY created DESC"
        )->fetchAll(PDO::FETCH_ASSOC);
    }

    /* admin – change status */
    public function setDelivered($id)
    {
        $q=$this->pdo->prepare("UPDATE orders SET status='delivered' WHERE id=?");
        return $q->execute([$id]);
    }
}


===== FILE: app\models\Pet.php =====
<?php
require_once 'core/Database.php';

class Pet extends Database
{
    public function all()
    {
        return $this->pdo->query("SELECT * FROM pets ORDER BY id DESC")
                         ->fetchAll(PDO::FETCH_ASSOC);
    }

    public function bySpecies($species)
    {
        $q = $this->pdo->prepare(
            "SELECT * FROM pets WHERE LOWER(species)=LOWER(?) ORDER BY id DESC"
        );
        $q->execute([$species]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    /* NEW: combined search by species + location (partial match). */
    public function search($species = null, $location = '')
    {
        $sql  = "SELECT * FROM pets WHERE 1";
        $args = [];

        if ($species) {
            $sql .= " AND LOWER(species)=LOWER(?)";
            $args[] = $species;
        }
        if ($location !== '') {
            $sql .= " AND LOWER(location) LIKE LOWER(?)";
            $args[] = "%".$location."%";
        }

        $sql .= " ORDER BY id DESC";
        $q = $this->pdo->prepare($sql);
        $q->execute($args);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    public function find($id)
    {
        $q = $this->pdo->prepare("SELECT * FROM pets WHERE id=?");
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO pets
               (name, species, age, breed, vaccinated, adopted,
                image, story, phone, email, location)
             VALUES (?,?,?,?,?,?,?,?,?,?,?)"
        );
        return $q->execute([
            $d['name'], $d['species'], $d['age'], $d['breed'],
            $d['vaccinated'], $d['adopted'], $d['image'], $d['story'],
            $d['phone'], $d['email'], $d['location']
        ]);
    }

    public function update($id, $d)
    {
        $q = $this->pdo->prepare(
            "UPDATE pets SET
                name=?, species=?, age=?, breed=?, vaccinated=?,
                adopted=?, image=?, story=?, phone=?, email=?, location=?
             WHERE id=?"
        );
        return $q->execute([
            $d['name'], $d['species'], $d['age'], $d['breed'], $d['vaccinated'],
            $d['adopted'], $d['image'], $d['story'], $d['phone'], $d['email'],
            $d['location'], $id
        ]);
    }

    public function delete($id)
    {
        $q = $this->pdo->prepare("DELETE FROM pets WHERE id=?");
        return $q->execute([$id]);
    }

    public function setAdopted($id, $flag = 1)
    {
        $q = $this->pdo->prepare("UPDATE pets SET adopted=? WHERE id=?");
        return $q->execute([(int)$flag, $id]);
    }
}


===== FILE: app\models\Product.php =====
<?php
require_once 'core/Database.php';

class Product extends Database
{
    /* READ */
    public function all()             { return $this->pdo->query("SELECT * FROM products")->fetchAll(PDO::FETCH_ASSOC); }
    public function byCategory($c)    {
        $q = $this->pdo->prepare("SELECT * FROM products WHERE LOWER(category) = LOWER(?)");
        $q->execute([$c]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }
    public function find($id)         { $q=$this->pdo->prepare("SELECT * FROM products WHERE id=?"); $q->execute([$id]); return $q->fetch(PDO::FETCH_ASSOC); }

    /* CREATE */
    public function create($d) {
        $q = $this->pdo->prepare("INSERT INTO products (name,category,price,image,description) VALUES (?,?,?,?,?)");
        return $q->execute([$d['name'],$d['category'],$d['price'],$d['image'],$d['description']]);
    }

    /* UPDATE */
    public function update($id,$d) {
        $q = $this->pdo->prepare("UPDATE products SET name=?,category=?,price=?,image=?,description=? WHERE id=?");
        return $q->execute([$d['name'],$d['category'],$d['price'],$d['image'],$d['description'],$id]);
    }

    /* DELETE */
    public function delete($id) {
        $q = $this->pdo->prepare("DELETE FROM products WHERE id=?");
        return $q->execute([$id]);
    }
}


===== FILE: app\models\Rehome.php =====
<?php
require_once 'core/Database.php';

class Rehome extends Database
{
    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO rehomes
             (user_id, owner_name, owner_email, owner_phone, address,
              name, species, age, breed, vaccinated, image, story,
              status, created)
             VALUES (?,?,?,?,?,?,?,?,?,?,?,?, 'pending', NOW())"
        );
        $q->execute([
            $d['user_id'], $d['owner_name'], $d['owner_email'], $d['owner_phone'], $d['address'],
            $d['name'], $d['species'], $d['age'], $d['breed'], $d['vaccinated'], $d['image'], $d['story']
        ]);
        return $this->pdo->lastInsertId();
    }

    public function all()
    {
        return $this->pdo->query(
            "SELECT * FROM rehomes ORDER BY created DESC"
        )->fetchAll(PDO::FETCH_ASSOC);
    }

    public function find($id)
    {
        $q = $this->pdo->prepare("SELECT * FROM rehomes WHERE id=?");
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    public function setStatus($id, $status)
    {
        $q = $this->pdo->prepare("UPDATE rehomes SET status=? WHERE id=?");
        return $q->execute([$status, $id]);
    }
}


===== FILE: app\models\Shelter.php =====
<?php
require_once 'core/Database.php';

class Shelter extends Database
{
    public function all()
    {
        return $this->pdo->query("SELECT * FROM shelters ORDER BY name ASC")
                         ->fetchAll(PDO::FETCH_ASSOC);
    }

    public function find($id)
    {
        $q = $this->pdo->prepare("SELECT * FROM shelters WHERE id=?");
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }
}


===== FILE: app\models\User.php =====
<?php
require_once 'core/Database.php';

class User extends Database
{
    public function create($d)
    {
        // accept optional phone/address/bio without breaking existing register flow
        $q = $this->pdo->prepare(
            "INSERT INTO users (username,email,password,role,phone,address,bio)
             VALUES (?,?,?,?,?,?,?)"
        );
        $q->execute([
            $d['username'],
            $d['email'],
            $d['password'],
            $d['role'] ?? 'user',
            $d['phone']   ?? null,
            $d['address'] ?? null,
            $d['bio']     ?? null,
        ]);
        return $this->pdo->lastInsertId();
    }

    public function checkLogin($email)
    {
        $q = $this->pdo->prepare("SELECT * FROM users WHERE email=?");
        $q->execute([$email]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    public function findById($id)
    {
        $q = $this->pdo->prepare("SELECT id,username,email,role,phone,address,bio FROM users WHERE id=?");
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }

    public function update($id, $d)
    {
        $q = $this->pdo->prepare("UPDATE users SET username=?, email=?, phone=?, address=?, bio=? WHERE id=?");
        return $q->execute([
            $d['username'],
            $d['email'],
            $d['phone'],
            $d['address'],
            $d['bio'],
            $id
        ]);
    }
}


===== FILE: app\models\Vaccination.php =====
<?php
require_once 'core/Database.php';

class Vaccination extends Database
{
    public function create($d)
    {
        $q = $this->pdo->prepare(
            "INSERT INTO vaccinations (user_id, pet_name, vaccine, dose, due_date, notes, status)
             VALUES (?,?,?,?,?,?, 'scheduled')"
        );
        $q->execute([
            $d['user_id'], $d['pet_name'], $d['vaccine'],
            $d['dose'], $d['due_date'], $d['notes']
        ]);
        return $this->pdo->lastInsertId();
    }

    public function byUser($uid)
    {
        $q = $this->pdo->prepare(
            "SELECT * FROM vaccinations WHERE user_id=? ORDER BY due_date ASC, id DESC"
        );
        $q->execute([$uid]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    /* Next reminders: due in next 30 days (and not done) */
    public function upcomingDue($uid, $days = 30, $limit = 5)
    {
        $q = $this->pdo->prepare(
            "SELECT * FROM vaccinations
              WHERE user_id=? AND status<>'done'
                AND due_date BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL ? DAY)
              ORDER BY due_date ASC
              LIMIT ".(int)$limit
        );
        $q->execute([$uid, (int)$days]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    public function setStatus($id, $uid, $status)
    {
        $q = $this->pdo->prepare("UPDATE vaccinations SET status=? WHERE id=? AND user_id=?");
        return $q->execute([$status, $id, $uid]);
    }

    public function delete($id, $uid)
    {
        $q = $this->pdo->prepare("DELETE FROM vaccinations WHERE id=? AND user_id=?");
        return $q->execute([$id, $uid]);
    }
}


===== FILE: app\models\Vet.php =====
<?php
require_once 'core/Database.php';

class Vet extends Database
{
    public function search($location = '')
    {
        if ($location==='') {
            return $this->pdo->query("SELECT * FROM vets ORDER BY city,name")->fetchAll(PDO::FETCH_ASSOC);
        }
        $q = $this->pdo->prepare("SELECT * FROM vets WHERE LOWER(city) LIKE LOWER(?) OR LOWER(address) LIKE LOWER(?) OR LOWER(name) LIKE LOWER(?) ORDER BY city,name");
        $like = "%".$location."%";
        $q->execute([$like,$like,$like]);
        return $q->fetchAll(PDO::FETCH_ASSOC);
    }

    public function find($id)
    {
        $q = $this->pdo->prepare("SELECT * FROM vets WHERE id=?");
        $q->execute([$id]);
        return $q->fetch(PDO::FETCH_ASSOC);
    }
}


===== FILE: app\views\admin\adoptions.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Admin • Adoption Applications</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{text-align:center;margin:90px 0 1.4rem;font-size:2rem;font-weight:600;color:#41403e}
table{width:100%;background:#fff;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:12px 14px;font-size:.9rem;vertical-align:top}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
img.thumb{width:44px;height:44px;object-fit:cover;border-radius:8px;margin-right:8px;vertical-align:middle}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem}
.pending{background:#fff3d6;color:#9b6b00;border:1px solid #f5d48a}
.accepted{background:#e7f8f4;color:#1b907d;border:1px solid #bfece1}
.rejected{background:#ffe6e6;color:#9c2a2a;border:1px solid #ffb2b2}
a.btn{display:inline-block;background:#26c1a8;color:#fff;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:600;margin-right:8px}
a.btn:hover{background:#1ea893}
a.btn-alt{display:inline-block;border:2px solid #26c1a8;color:#26c1a8;text-decoration:none;padding:6px 10px;border-radius:10px;font-weight:600}
a.btn-alt:hover{background:#e7f8f4}
.when{color:#777;font-size:.85rem}
.email,.phone{color:#555}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>Adoption Applications</h1>

<table>
<thead>
<tr>
  <th>ID</th>
  <th>Submitted</th>
  <th>Pet</th>
  <th>Applicant</th>
  <th>Contact</th>
  <th>City/State</th>
  <th>Status</th>
  <th style="width:22%">Actions</th>
</tr>
</thead>
<tbody>
<?php foreach($apps as $a): ?>
<tr>
  <td><?=$a['id']?></td>
  <td class="when"><?=date('Y-m-d H:i', strtotime($a['created']))?></td>
  <td>
    <img class="thumb" src="<?=htmlspecialchars($a['pet_image'])?>" alt="">
    <?=htmlspecialchars($a['pet_name'])?>
  </td>
  <td><?=htmlspecialchars($a['applicant_name'])?></td>
  <td>
    <div class="email"><?=htmlspecialchars($a['email'])?></div>
    <div class="phone"><?=htmlspecialchars($a['phone'])?></div>
  </td>
  <td><?=htmlspecialchars($a['city_state'])?></td>
  <td><span class="badge <?=$a['status']?>"><?=ucfirst($a['status'])?></span></td>
  <td>
    <?php if($a['status']==='pending'): ?>
      <a class="btn" href="<?=BASE_URL?>/AdminAdoption/accept?id=<?=$a['id']?>" onclick="return confirm('Accept this application and mark the pet as Adopted?')">Accept</a>
      <a class="btn-alt" href="<?=BASE_URL?>/AdminAdoption/reject?id=<?=$a['id']?>" onclick="return confirm('Reject this application?')">Reject</a>
    <?php else: ?><span class="when">No actions</span><?php endif; ?>
  </td>
</tr>
<?php endforeach; ?>
</tbody>
</table>
</body></html>


===== FILE: app\views\admin\donations.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Admin • Donations</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{text-align:center;margin:90px 0 1.6rem;font-size:2rem;font-weight:600;color:#41403e}
table{width:100%;background:#fff;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.9rem;vertical-align:top}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
.amount{font-weight:700;color:#ff8552}
.note{color:#555;font-size:.85rem}
.when{color:#777;font-size:.85rem}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>Donations</h1>

<table>
<thead>
  <tr>
    <th>ID</th>
    <th>Date</th>
    <th>Shelter</th>
    <th>Donor Name</th>
    <th>Donor Email</th>
    <th>Amount</th>
    <th>Note</th>
  </tr>
</thead>
<tbody>
<?php foreach($donations as $d): ?>
<tr>
  <td><?=$d['id']?></td>
  <td class="when"><?=date('Y-m-d H:i', strtotime($d['created']))?></td>
  <td><?=htmlspecialchars($d['shelter_name'] ?? '—')?></td>
  <td><?=htmlspecialchars($d['name'] ?: '—')?></td>
  <td><?=htmlspecialchars($d['email'] ?: '—')?></td>
  <td class="amount">$<?=number_format($d['amount'],2)?></td>
  <td class="note"><?=htmlspecialchars($d['note'] ?: '')?></td>
</tr>
<?php endforeach; ?>
</tbody>
</table>
</body></html>


===== FILE: app\views\admin\form.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title><?=($data['mode']=='add'?'Add':'Edit')?> Product</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:1rem}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);width:420px;padding:36px}
h2{color:#41403e;font-size:1.6rem;font-weight:600;margin-bottom:1.3rem;text-align:center}
label{display:block;font-weight:600;color:#41403e;margin-top:14px;font-size:.95rem}
input,textarea,select{width:100%;padding:.75rem 1rem;border:2px solid #e9e7e6;border-radius:10px;margin-top:.35rem;font-size:.9rem}
input:focus,textarea:focus,select:focus{border-color:#26c1a8;outline:none}
button{margin-top:22px;background:#26c1a8;color:#fff;border:none;width:100%;padding:.9rem;font-weight:600;font-size:1rem;border-radius:10px;cursor:pointer;transition:.3s background}
button:hover{background:#1ea893}
</style></head><body>
  
<div class="card">
    <h2><?=($data['mode']=='add'?'Add':'Edit')?> Product</h2>
    <?php
        /* defaults when adding */
        $p = $data['mode']=='edit' ? $data['prod']
                                   : ['id'=>'','name'=>'','price'=>'','image'=>'','description'=>'','category'=>'Food'];
        /* form action: keep id in query for GET + hidden for POST */
        $action = $data['mode']=='add'
                  ? BASE_URL.'/Admin/add'
                  : BASE_URL.'/Admin/edit?id='.$p['id'];
    ?>
    <form method="POST" action="<?=$action?>">
        <?php if($data['mode']=='edit'): ?>
            <input type="hidden" name="id" value="<?=$p['id']?>">
        <?php endif; ?>

        <label>Name</label>
        <input type="text" name="name" value="<?=htmlspecialchars($p['name'])?>" required>

        <label>Category</label>
        <select name="category">
            <?php foreach(['Food','Medicine','Toy','Accessories'] as $c): ?>
                <option value="<?=$c?>" <?=$p['category']===$c?'selected':''?>><?=$c?></option>
            <?php endforeach;?>
        </select>

        <label>Price (USD)</label>
        <input type="number" step="0.01" name="price" value="<?=$p['price']?>" required>

        <label>Image URL</label>
        <input type="text" name="image" value="<?=htmlspecialchars($p['image'])?>" required>

        <label>Description</label>
        <textarea name="description" rows="3" required><?=htmlspecialchars($p['description'])?></textarea>

        <button type="submit"><?=$data['mode']=='add'?'Save':'Update'?></button>
    </form>
</div>
</body></html>


===== FILE: app\views\admin\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Admin • Products</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{font-size:2rem;font-weight:600;color:#41403e;margin-bottom:1.6rem;text-align:center}
a.btn{background:#26c1a8;color:#fff;text-decoration:none;padding:10px 22px;border-radius:10px;font-weight:600}
a.btn:hover{background:#1ea893}
table{width:100%;margin-top:20px;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.9rem}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
.actions a{margin-right:10px;color:#ff8552;text-decoration:none;font-weight:600}
.actions a:hover{color:#e4713f}
</style></head><body>
  <?php include_once 'app/views/partials/nav.php'; ?>

<h1>🐾 Admin Dashboard – Products</h1>
<div style="text-align:right"><a class="btn" href="<?=BASE_URL?>/Admin/add">+ Add Product</a></div>

<table>
<thead><tr><th>ID</th><th>Name</th><th>Cat.</th><th>Price</th><th style="width:22%">Actions</th></tr></thead>
<tbody>
<?php foreach($data['products'] as $p): ?>
<tr>
    <td><?=$p['id']?></td>
    <td><?=htmlspecialchars($p['name'])?></td>
    <td><?=$p['category']?></td>
    <td>$<?=number_format($p['price'],2)?></td>
    <td class="actions">
        <!-- now uses ?id= to pass product id -->
        <a href="<?=BASE_URL?>/Admin/edit?id=<?=$p['id']?>">Edit</a>
        <a href="<?=BASE_URL?>/Admin/delete?id=<?=$p['id']?>" onclick="return confirm('Delete this product?')">Delete</a>
    </td>
</tr>
<?php endforeach;?>
</tbody>
</table>
</body></html>


===== FILE: app\views\admin\orders.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>All Orders • Admin</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{text-align:center;margin:90px 0 1.6rem;font-size:2rem;font-weight:600;color:#41403e}
table{width:100%;background:#fff;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.9rem}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
a.dbtn{color:#ff8552;text-decoration:none;font-weight:600}
a.dbtn:hover{color:#e4713f}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>All Orders</h1>

<table>
<thead><tr>
  <th>ID</th><th>User&nbsp;ID</th><th>Date</th><th>Items</th>
  <th>Total</th><th>Status</th><th>Action</th>
</tr></thead>
<tbody>
<?php foreach($orders as $o): ?>
<tr>
  <td><?=$o['id']?></td>
  <td><?=$o['user_id']?></td>
  <td><?=date('Y-m-d H:i', strtotime($o['created']))?></td>
  <td style="width:30%"><?=htmlspecialchars($o['items'])?></td>
  <td>$<?=number_format($o['total'],2)?></td>
  <td><?=$o['status']?></td>
  <td>
    <?php if($o['status']==='pending'): ?>
       <a class="dbtn" href="<?=BASE_URL?>/AdminOrder/deliver?id=<?=$o['id']?>">Mark&nbsp;Delivered</a>
    <?php endif;?>
  </td>
</tr>
<?php endforeach;?>
</tbody>
</table>
</body></html>


===== FILE: app\views\admin\pets.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Admin • Pets</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{font-size:2rem;font-weight:600;color:#41403e;margin-bottom:1.6rem;text-align:center}
a.btn{background:#26c1a8;color:#fff;text-decoration:none;padding:10px 22px;border-radius:10px;font-weight:600}
a.btn:hover{background:#1ea893}
table{width:100%;margin-top:20px;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.9rem}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
.status{font-weight:600}
.available{color:#26c1a8}
.adopted{color:#aaa}
.actions a{margin-right:10px;color:#ff8552;text-decoration:none;font-weight:600}
.actions a:hover{color:#e4713f}
img.thumb{height:40px;width:40px;object-fit:cover;border-radius:50%}
.contact{font-size:.85rem;line-height:1.3;color:#41403e}
.contact .addr{font-size:.78rem;color:#777}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>🐾 Admin Dashboard – Pets</h1>
<div style="text-align:right"><a class="btn" href="<?=BASE_URL?>/AdminPet/add">+ Add Pet</a></div>

<table>
<thead>
  <tr>
    <th>ID</th><th>Photo</th><th>Name</th><th>Species</th>
    <th>Breed</th><th>Contact Details</th><th>Status</th><th style="width:22%">Actions</th>
  </tr>
</thead>
<tbody>
<?php foreach($pets as $p): ?>
<tr>
  <td><?=$p['id']?></td>
  <td><img class="thumb" src="<?=htmlspecialchars($p['image'])?>" alt=""></td>
  <td><?=htmlspecialchars($p['name'])?></td>
  <td><?=htmlspecialchars($p['species'])?></td>
  <td><?=htmlspecialchars($p['breed'])?></td>

  <td class="contact">
    <?=htmlspecialchars($p['phone'] ?: '—')?><br>
    <?=htmlspecialchars($p['email'] ?: '—')?><br>
    <span class="addr"><?=htmlspecialchars($p['location'] ?: '')?></span>
  </td>

  <td class="status <?=$p['adopted']?'adopted':'available'?>">
    <?=$p['adopted']?'Adopted':'Available'?>
  </td>

  <td class="actions">
    <a href="<?=BASE_URL?>/AdminPet/edit?id=<?=$p['id']?>">Edit</a>
    <a href="<?=BASE_URL?>/AdminPet/delete?id=<?=$p['id']?>" onclick="return confirm('Delete this pet?')">Delete</a>
  </td>
</tr>
<?php endforeach;?>
</tbody>
</table>
</body></html>


===== FILE: app\views\admin\pet_form.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title><?=($data['mode']=='add'?'Add':'Edit')?> Pet</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:1rem}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);width:420px;padding:36px}
h2{color:#41403e;font-size:1.6rem;font-weight:600;margin-bottom:1.3rem;text-align:center}
label{display:block;font-weight:600;color:#41403e;margin-top:14px;font-size:.95rem}
input,textarea,select{width:100%;padding:.75rem 1rem;border:2px solid #e9e7e6;border-radius:10px;margin-top:.35rem;font-size:.9rem}
input:focus,textarea:focus,select:focus{border-color:#26c1a8;outline:none}
button{margin-top:22px;background:#26c1a8;color:#fff;border:none;width:100%;padding:.9rem;font-weight:600;font-size:1rem;border-radius:10px;cursor:pointer;transition:.3s background}
button:hover{background:#1ea893}
.section-title{margin-top:20px;font-weight:600;color:#41403e;font-size:1rem}
.contact-box{background:#fafafa;border:1px solid #e9e7e6;border-radius:10px;padding:18px;margin-top:10px}
.contact-box label:first-child{margin-top:0}
</style></head><body>

<div class="card">
  <h2><?=($data['mode']=='add'?'Add':'Edit')?> Pet</h2>
<?php
  $p = $data['mode']=='edit' ? $data['pet']
                             : ['id'=>'','name'=>'','species'=>'Dog','age'=>'','breed'=>'',
                                'vaccinated'=>1,'adopted'=>0,'image'=>'','story'=>'',
                                'phone'=>'','email'=>'','location'=>''];
  $action = $data['mode']=='add'
            ? BASE_URL.'/AdminPet/add'
            : BASE_URL.'/AdminPet/edit?id='.$p['id'];
?>
  <form method="POST" action="<?=$action?>">
    <?php if($data['mode']=='edit'): ?>
      <input type="hidden" name="id" value="<?=$p['id']?>">
    <?php endif; ?>

    <label>Species</label>
    <select name="species">
      <option value="Dog"  <?=$p['species']==='Dog'?'selected':''?>>Dog</option>
      <option value="Cat"  <?=$p['species']==='Cat'?'selected':''?>>Cat</option>
    </select>

    <label>Name</label>
    <input type="text" name="name" value="<?=htmlspecialchars($p['name'])?>" required>

    <label>Age</label>
    <input type="text" name="age" value="<?=htmlspecialchars($p['age'])?>" required>

    <label>Breed</label>
    <input type="text" name="breed" value="<?=htmlspecialchars($p['breed'])?>" required>

    <label>Vaccinated</label>
    <select name="vaccinated">
      <option value="1" <?=$p['vaccinated']?'selected':''?>>Yes</option>
      <option value="0" <?=!$p['vaccinated']?'selected':''?>>No</option>
    </select>

    <label>Adopted</label>
    <select name="adopted">
      <option value="0" <?=$p['adopted']?'':'selected'?>>Available</option>
      <option value="1" <?=$p['adopted']?'selected':''?>>Adopted</option>
    </select>

    <label>Image URL</label>
    <input type="text" name="image" value="<?=htmlspecialchars($p['image'])?>" required>

    <label>Story</label>
    <textarea name="story" rows="3" required><?=htmlspecialchars($p['story'])?></textarea>

    <div class="section-title">Contact Details</div>
    <div class="contact-box">
      <label>Phone</label>
      <input type="text" name="phone" value="<?=htmlspecialchars($p['phone'])?>">

      <label>Email</label>
      <input type="email" name="email" value="<?=htmlspecialchars($p['email'])?>">

      <label>Location</label>
      <input type="text" name="location" value="<?=htmlspecialchars($p['location'])?>">
    </div>

    <button type="submit"><?=$data['mode']=='add'?'Save':'Update'?></button>
  </form>
</div>
</body></html>


===== FILE: app\views\admin\rehomes.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Admin • ReHome Requests</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{text-align:center;margin:90px 0 1.4rem;font-size:2rem;font-weight:600;color:#41403e}
table{width:100%;background:#fff;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:12px 14px;font-size:.9rem;vertical-align:top}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem}
.pending{background:#fff3d6;color:#9b6b00;border:1px solid #f5d48a}
.accepted{background:#e7f8f4;color:#1b907d;border:1px solid #bfece1}
.rejected{background:#ffe6e6;color:#9c2a2a;border:1px solid #ffb2b2}
a.btn{display:inline-block;background:#26c1a8;color:#fff;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:600;margin-right:8px}
a.btn:hover{background:#1ea893}
a.btn-alt{display:inline-block;border:2px solid #26c1a8;color:#26c1a8;text-decoration:none;padding:6px 10px;border-radius:10px;font-weight:600}
a.btn-alt:hover{background:#e7f8f4}
.note{color:#555;white-space:pre-wrap}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>ReHome Requests</h1>

<table>
<thead>
  <tr>
    <th>ID</th><th>Date</th><th>Pet</th><th>Owner</th>
    <th>Contact</th><th>Address</th><th>Status</th><th style="width:22%">Actions</th>
  </tr>
</thead>
<tbody>
<?php foreach($list as $r): ?>
<tr>
  <td><?=$r['id']?></td>
  <td><?=date('Y-m-d H:i', strtotime($r['created']))?></td>
  <td>
    <div><b><?=htmlspecialchars($r['name'])?></b> (<?=htmlspecialchars($r['species'])?>)</div>
    <?php if(!empty($r['image'])): ?>
      <div><img src="<?=htmlspecialchars($r['image'])?>" alt="" style="height:44px;width:44px;object-fit:cover;border-radius:8px;margin-top:4px"></div>
    <?php endif; ?>
    <div class="note"><?=htmlspecialchars($r['story'])?></div>
  </td>
  <td><?=htmlspecialchars($r['owner_name'])?></td>
  <td>
    <div><?=htmlspecialchars($r['owner_email'])?></div>
    <div><?=htmlspecialchars($r['owner_phone'])?></div>
  </td>
  <td><?=htmlspecialchars($r['address'])?></td>
  <td><span class="badge <?=$r['status']?>"><?=ucfirst($r['status'])?></span></td>
  <td>
    <?php if($r['status']==='pending'): ?>
      <a class="btn" href="<?=BASE_URL?>/AdminRehome/accept?id=<?=$r['id']?>" onclick="return confirm('Accept and add this pet to the list?')">Accept</a>
      <a class="btn-alt" href="<?=BASE_URL?>/AdminRehome/reject?id=<?=$r['id']?>" onclick="return confirm('Reject this request?')">Reject</a>
    <?php else: ?>
      <span style="color:#777">No actions</span>
    <?php endif; ?>
  </td>
</tr>
<?php endforeach; ?>
</tbody>
</table>
</body></html>


===== FILE: app\views\adoption\apply.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>Apply to Adopt • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --brand:#26c1a8; --brand-2:#ff8552; --ink:#41403e; --text:#555; --muted:#777;
  --card:#fff; --bg:#f0faf6; --line:#e9e7e6;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);padding:42px 6%}

/* ===== Hero (pet image + guidelines) ===== */
.hero{
  max-width:1000px;margin:86px auto 16px;background:var(--card);
  border-radius:18px;box-shadow:0 8px 18px rgba(0,0,0,.08);
  display:flex;overflow:hidden
}
.hero-img{width:38%;min-height:280px;object-fit:cover}
.hero-txt{width:62%;padding:26px 30px}
h1{font-size:1.7rem;font-weight:600;color:var(--ink);line-height:1.2}
.small{color:var(--muted);font-size:.9rem;margin-top:6px}
ol{margin:10px 0 0 22px}
ol li{color:var(--text);line-height:1.55;margin:.32rem 0}
ol li::marker{content:"🐾 ";}

/* ===== Card / Form ===== */
.card{
  background:var(--card);border-radius:18px;box-shadow:0 8px 18px rgba(0,0,0,.08);
  max-width:1000px;margin:18px auto;padding:26px 30px
}
.section{margin-top:16px;padding-top:12px;border-top:2px dashed #eef3f1}
.section:first-of-type{border-top:none;padding-top:0;margin-top:0}
.section h2{
  font-size:1.05rem;color:var(--ink);font-weight:700;margin-bottom:6px;
  display:flex;align-items:center;gap:8px
}
.section h2 .tag{background:var(--brand);color:#fff;border-radius:999px;padding:4px 10px;font-size:.8rem}

/* Inputs */
label{display:block;font-weight:600;color:var(--ink);margin-top:14px;font-size:.95rem}
input,textarea,select{
  width:100%;padding:.8rem 1rem;border:2px solid var(--line);
  border-radius:12px;margin-top:.45rem;font-size:.95rem;background:#fff
}
input:focus,textarea:focus,select:focus{outline:none;border-color:var(--brand)}
.row{display:flex;gap:12px;flex-wrap:wrap}
.col{flex:1 1 260px}

/* ===== Fixed option alignment ===== */
.group{margin-top:10px}
.opts-grid{
  display:grid;gap:8px;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
  margin-top:6px
}
.option{
  display:flex;align-items:center;gap:10px;          /* ← center-align vertically */
  color:var(--text); line-height:1.35; padding:6px 4px
}
.option input{
  flex:0 0 auto; width:18px; height:18px;            /* ← uniform control size */
  margin:0; accent-color:var(--brand);               /* brand tick, matches theme */
}
.option span{display:block}

/* Button */
button{
  margin-top:20px;background:var(--brand);color:#fff;border:none;width:100%;
  padding:.95rem;font-weight:700;font-size:1rem;border-radius:12px;cursor:pointer;transition:.25s
}
button:hover{background:#1ea893}
.helper{color:var(--muted);font-size:.85rem;margin-top:8px}

/* Responsive */
@media (max-width:900px){
  .hero{flex-direction:column}
  .hero-img,.hero-txt{width:100%}
}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<!-- ===== Guidelines ===== -->
<div class="hero">
  <img class="hero-img" src="<?=htmlspecialchars($pet['image'])?>" alt="<?=htmlspecialchars($pet['name'])?>">
  <div class="hero-txt">
    <h1>Adoption Guidelines for <span style="background:#eaf8f5;color:var(--brand);border:1px solid #d6f2ea;border-radius:999px;padding:4px 10px;font-size:.9rem;font-weight:700"><?=htmlspecialchars($pet['name'])?></span></h1>
    <div class="small">Please read these friendly rules before submitting your application.</div>
    <ol>
      <li><b>Minimum Age:</b> You must be at least 18 years old.</li>
      <li><b>Vet Reference:</b> Responsible care includes annual exams and vaccinations.</li>
      <li><b>Spay/Neuter:</b> All pets are spayed/neutered (unless medically exempt).</li>
      <li><b>Home Setup:</b> Indoor homes; fenced yards may be required for some dogs.</li>
      <li><b>Other Pets:</b> We’ll confirm compatibility and basic health tests when needed.</li>
      <li><b>Renters:</b> Please confirm pets are allowed (and deposits if required).</li>
      <li><b>Home Visit:</b> A short home check may be requested by appointment.</li>
    </ol>
  </div>
</div>

<!-- ===== Application Form ===== -->
<div class="card">
  <form method="POST" action="<?=BASE_URL?>/Adoption/apply?pet_id=<?=$pet['id']?>">
    <input type="hidden" name="pet_id" value="<?=$pet['id']?>">

    <div class="section">
      <h2><span class="tag">Step 1</span> Basics</h2>
      <div class="row">
        <div class="col">
          <label>App Date</label>
          <input type="text" value="<?=date('n/j/Y')?>" readonly>
        </div>
        <div class="col">
          <label>Pet</label>
          <input type="text" value="<?=htmlspecialchars($pet['name'])?>" readonly>
        </div>
      </div>

      <label>Name of Applicant *</label>
      <input type="text" name="applicant_name" required>

      <div class="row">
        <div class="col">
          <label>Email address *</label>
          <input type="email" name="email" required>
        </div>
        <div class="col">
          <label>Best Contact Phone Number *</label>
          <input type="text" name="phone" required>
        </div>
      </div>

      <label>Your City & State *</label>
      <input type="text" name="city_state" placeholder="e.g., Dhanmondi, Dhaka" required>

      <div class="group">
        <label>Can we text you at that number? *</label>
        <div class="opts-grid" style="grid-template-columns:repeat(2, minmax(120px,1fr))">
          <label class="option"><input type="radio" name="can_text" value="1" required><span>Yes, please.</span></label>
          <label class="option"><input type="radio" name="can_text" value="0"><span>No, thank you.</span></label>
        </div>
      </div>
    </div>

    <div class="section">
      <h2><span class="tag">Step 2</span> Tell us a little more</h2>

      <label>How did you hear about our adoptable pets? (select all that apply)</label>
      <div class="opts-grid">
        <label class="option"><input type="checkbox" name="heard[]" value="Website"><span>Website</span></label>
        <label class="option"><input type="checkbox" name="heard[]" value="Facebook"><span>Facebook</span></label>
        <label class="option"><input type="checkbox" name="heard[]" value="Instagram"><span>Instagram</span></label>
        <label class="option"><input type="checkbox" name="heard[]" value="Friend/Family"><span>Friend/Family</span></label>
        <label class="option"><input type="checkbox" name="heard[]" value="Other"><span>Other</span></label>
      </div>

      <label>Do you currently have any companion animals in your home? (select all that apply)</label>
      <div class="opts-grid">
        <label class="option"><input type="checkbox" name="current_pets[]" value="None"><span>None</span></label>
        <label class="option"><input type="checkbox" name="current_pets[]" value="1 Dog"><span>1 Dog</span></label>
        <label class="option"><input type="checkbox" name="current_pets[]" value="2+ Dogs"><span>2+ Dogs</span></label>
        <label class="option"><input type="checkbox" name="current_pets[]" value="1 Cat"><span>1 Cat</span></label>
        <label class="option"><input type="checkbox" name="current_pets[]" value="2+ Cats"><span>2+ Cats</span></label>
        <label class="option"><input type="checkbox" name="current_pets[]" value="Other"><span>Other</span></label>
      </div>

      <label>What are you looking for in a companion dog/cat? (select all that apply)</label>
      <div class="opts-grid">
        <label class="option"><input type="checkbox" name="looking_for[]" value="Company for my other animal(s)"><span>Company for my other animal(s)</span></label>
        <label class="option"><input type="checkbox" name="looking_for[]" value="A new best friend"><span>A new best friend</span></label>
        <label class="option"><input type="checkbox" name="looking_for[]" value="Good with cats"><span>A pet that gets along with cats</span></label>
        <label class="option"><input type="checkbox" name="looking_for[]" value="Good with kids"><span>A pet good with children</span></label>
        <label class="option"><input type="checkbox" name="looking_for[]" value="To help rescue a pet in need"><span>To help rescue a pet in need</span></label>
      </div>
    </div>

    <div class="section">
      <h2><span class="tag">Step 3</span> Home & Household</h2>

      <label>Household Type *</label>
      <div class="opts-grid">
        <label class="option"><input type="checkbox" name="house_type[]" value="Apartment"><span>Apartment</span></label>
        <label class="option"><input type="checkbox" name="house_type[]" value="Condo/Townhouse (fenced yard)"><span>Condo/Townhouse (fenced yard)</span></label>
        <label class="option"><input type="checkbox" name="house_type[]" value="Condo/Townhouse (no yard)"><span>Condo/Townhouse (no yard)</span></label>
        <label class="option"><input type="checkbox" name="house_type[]" value="Residential w/ fenced yard"><span>Residential home with fenced yard</span></label>
        <label class="option"><input type="checkbox" name="house_type[]" value="Residential w/ yard, no fence"><span>Residential home with yard, no fence</span></label>
        <label class="option"><input type="checkbox" name="house_type[]" value="Other"><span>Other</span></label>
      </div>

      <label>Household Members *</label>
      <textarea name="house_members" rows="3" placeholder="Ages / number of people" required></textarea>

      <label>Is there anything else you'd like to share with us?</label>
      <textarea name="notes" rows="3" placeholder="Any special needs, schedule, preferences"></textarea>
    </div>

    <div class="section">
      <h2><span class="tag">Final</span> Agreement</h2>
      <label class="option" style="margin-top:6px">
        <input type="checkbox" name="agree" value="1" required><span>I acknowledge the guidelines above and am able to proceed with adoption steps.</span>
      </label>

    
      <div class="helper">We’ll get back to you via email within 72 hours.</div>

      <button type="submit">Submit Adoption Application</button>
    </div>
  </form>
</div>
</body></html>


===== FILE: app\views\adoption\thanks.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>Application Submitted • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6}
.wrap{padding:40px 6%}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);padding:26px 28px;max-width:980px;margin:80px auto 24px}
.grid{display:grid;grid-template-columns:1fr 1.1fr;gap:24px;align-items:center}
@media(max-width:860px){.grid{grid-template-columns:1fr}}
.pic img{width:100%;max-width:380px;height:340px;object-fit:cover;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08)}
.badge{display:inline-block;background:#26c1a8;color:#fff;padding:8px 16px;border-radius:999px;font-weight:700;margin-top:10px}
h1{color:#41403e;font-size:1.8rem;font-weight:600;margin-bottom:.6rem}
p{color:#555;line-height:1.5;margin-bottom:10px}
a.btn{display:inline-block;text-decoration:none;background:#26c1a8;color:#fff;padding:12px 24px;border-radius:12px;font-weight:600}
a.btn:hover{background:#1ea893}
.small{color:#777;font-size:.9rem;margin-top:8px}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<div class="wrap">
  <div class="card">
    <div class="grid">
      <div class="pic">
        <img src="<?=htmlspecialchars($app['pet_image'] ?: 'https://images.unsplash.com/photo-1525253013412-55c1a69a5738?auto=format&fit=crop&w=640&q=80')?>" alt="">
        <div class="badge">Application sent!</div>
      </div>
      <div>
        <h1>Thanks for applying to adopt <?=htmlspecialchars($app['pet_name'])?> 🐾</h1>
        <p>We received your application for <?=htmlspecialchars($app['pet_name'])?>. Our team will review your info and contact you by email shortly.</p>
        <p class="small">Submitted by <b><?=htmlspecialchars($app['applicant_name'])?></b> • <?=htmlspecialchars($app['email'])?></p>
        <a class="btn" href="<?=BASE_URL?>/Pet/index">Back to Pets</a>
      </div>
    </div>
  </div>
</div>
</body></html>


===== FILE: app\views\appointment\book.php =====
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Book Appointment • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --brand:#26c1a8; --brand2:#1ea893;
  --ink:#163c35; --muted:#6c7e7b; --bg:#f0faf6; --card:#fff; --line:#e9e7e6; --danger:#ff6b6b;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);color:var(--ink);padding:40px 6%}
.wrap{max-width:960px;margin:92px auto 26px}
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 20px rgba(0,0,0,.06);padding:18px}
.header{display:grid;grid-template-columns:240px 1fr;gap:16px}
@media (max-width:800px){.header{grid-template-columns:1fr}}
.hero{width:100%;aspect-ratio:4/3;border-radius:12px;overflow:hidden;background:#f6f8f8}
.hero img{width:100%;height:100%;object-fit:cover;display:block}
h1{font-size:1.5rem;margin-bottom:6px}
.meta{color:#4c5e5b;font-size:.95rem;margin-top:6px}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem;border:1px solid #bfece1;background:#e7f8f4;color:#1b907d}
.badge.red{border-color:#ffc3c3;background:#ffe9e9;color:#c43a3a}
.helpline{margin-top:8px;font-weight:700}
.helpline a{color:var(--brand);text-decoration:none}

/* date switcher */
.switcher{margin:14px 0 8px;display:flex;gap:10px;flex-wrap:wrap}
.switcher input{padding:.7rem;border:2px solid var(--line);border-radius:12px}
.switcher button{padding:.7rem 1rem;border:none;border-radius:12px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer}
.switcher button:hover{background:var(--brand2)}

/* slots */
h2{font-size:1.1rem;margin:12px 0 8px}
.legend{font-size:.85rem;color:#6a7a77;margin-bottom:6px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(110px,1fr));gap:10px}
.slot{position:relative}
.slot input{display:none}
.slot label{
  display:block;text-align:center;padding:.8rem;border-radius:12px;border:2px solid var(--brand);
  color:var(--brand);cursor:pointer;font-weight:700;background:#e7f8f4;
}
.slot input:checked + label{background:var(--brand);color:#fff}
.slot.busy label{border-color:#ffc3c3;background:#ffe9e9;color:#c43a3a;cursor:not-allowed}
.slot.busy label:after{content:"Booked";position:absolute;right:8px;top:8px;font-size:.7rem;background:#ffdad9;color:#9c2a2a;padding:2px 6px;border-radius:999px}
.actions{margin-top:12px;display:grid;gap:10px}
input[type="text"],textarea{width:100%;padding:.85rem;border:2px solid var(--line);border-radius:12px}
input[type="text"]:focus,textarea:focus{outline:none;border-color:var(--brand)}
button.primary{padding:1rem;border:none;border-radius:12px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer}
button.primary:hover{background:var(--brand2)}
</style>
</head>
<body>
<?php include_once 'app/views/partials/nav.php'; ?>
<div class="wrap">
  <div class="card">
    <div class="header">
      <figure class="hero">
        <?php $placeholder='https://images.unsplash.com/photo-1559757148-5c350d0d3c56?q=80&w=1200&auto=format&fit=crop';
              $img = $vet['photo'] ?: $placeholder; ?>
        <img src="<?=htmlspecialchars($img)?>" alt="<?=htmlspecialchars($vet['name'])?>" onerror="this.src='<?=htmlspecialchars($placeholder)?>'">
      </figure>
      <div>
        <h1><?=htmlspecialchars($vet['name'])?>
          <?php
            $is247 = (isset($vet['is_24_7']) && (int)$vet['is_24_7']===1) || (!empty($vet['hours']) && stripos($vet['hours'],'24/7')!==false);
            if($is247): ?><span class="badge">24/7</span><?php endif; ?>
        </h1>
        <div class="meta">📍 <?=htmlspecialchars($vet['city'])?> — <?=htmlspecialchars($vet['address'])?></div>
        <?php if(!empty($vet['phone'])): ?><div class="meta">☎️ <?=htmlspecialchars($vet['phone'])?></div><?php endif; ?>
        <?php if(!empty($vet['hours'])): ?><div class="meta">⏰ Hours: <?=htmlspecialchars($vet['hours'])?></div><?php endif; ?>
        <div class="helpline">Online Helpline: <a href="tel:+880170000000">+880 1700-000000</a> <span class="badge">24/7</span></div>

        <!-- date switcher -->
        <form class="switcher" method="get" action="<?=BASE_URL?>/Appointment/book">
          <input type="hidden" name="vet_id" value="<?=$vet['id']?>">
          <input type="date" name="date" value="<?=$date?>">
          <button type="submit">Check Date</button>
        </form>

        <h2>Available slots for checkup — <?=date('M d, Y', strtotime($date))?></h2>
        <div class="legend">Green = Available &nbsp;&nbsp;|&nbsp;&nbsp; <span class="badge red" style="border:none">Red</span> = Booked</div>

        <!-- booking form -->
        <form method="post" action="<?=BASE_URL?>/Appointment/book">
          <input type="hidden" name="vet_id" value="<?=$vet['id']?>">
          <input type="hidden" name="appt_date" value="<?=$date?>">

          <div class="grid">
            <?php foreach($slots as $s):
                  $busy = in_array($s,$taken,true); ?>
              <div class="slot <?=$busy?'busy':''?>">
                <?php if($busy): ?>
                  <input disabled type="radio" id="s<?=$s?>">
                  <label for="s<?=$s?>"><?=$s?></label>
                <?php else: ?>
                  <input type="radio" name="slot" id="s<?=$s?>" value="<?=$s?>">
                  <label for="s<?=$s?>"><?=$s?></label>
                <?php endif; ?>
              </div>
            <?php endforeach; ?>
          </div>

          <div class="actions">
            <input type="text" name="pet_name" placeholder="Your pet's name *" required>
            <textarea name="notes" rows="2" placeholder="Notes for the vet (optional)"></textarea>
            <button class="primary" type="submit">Confirm Booking</button>
          </div>
        </form>

      </div>
    </div>
  </div>
</div>
</body>
</html>


===== FILE: app\views\appointment\history.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Appointment History • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
.container{max-width:1050px;margin:90px auto 40px}
h1{font-size:2rem;font-weight:600;color:#41403e;margin-bottom:16px;text-align:center}
.sub{color:#6f7b78;font-size:.95rem;text-align:center;margin-bottom:24px}

.table{width:100%;border-collapse:collapse;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.92rem;vertical-align:top}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}

.when{color:#1b3f39;font-weight:700}
.where{color:#445b58}
.pet{color:#445b58}
.note{color:#6a6a6a;font-size:.85rem}

.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem;margin-left:6px}
.booked{background:#e7f8f4;border:1px solid #bfece1;color:#1b907d}
.completed{background:#e8eafc;border:1px solid #c7cbff;color:#343a8b}
.cancelled{background:#ffe6e6;border:1px solid #ffb2b2;color:#9c2a2a}
.expired{background:#fff3d6;border:1px solid #f5d48a;color:#9b6b00}

.btn{display:inline-block;border:2px solid #26c1a8;color:#26c1a8;padding:.55rem .9rem;border-radius:10px;font-weight:700;text-decoration:none}
.btn:hover{background:#eaf8f5}
.empty{background:#fff;border:1px solid #e9e7e6;border-radius:12px;padding:18px;text-align:center;color:#60706d}
.topbar{display:flex;justify-content:flex-end;margin:10px 0 16px}
</style>
</head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<div class="container">
  <h1>Appointment History</h1>
  <div class="sub">All of your bookings in one place. Past, cancelled, and completed visits are listed below.</div>

  <div class="topbar">
    <a class="btn" href="<?=BASE_URL?>/Appointment/index">Book a Vet</a>
  </div>

<?php if (empty($list)): ?>
  <div class="empty">No appointments yet. Click “Book a Vet” to get started.</div>
<?php else: ?>

  <table class="table">
    <thead>
      <tr>
        <th style="width:180px">When</th>
        <th>Clinic</th>
        <th>For</th>
        <th style="width:120px">Status</th>
        <th style="width:28%">Notes</th>
      </tr>
    </thead>
    <tbody>
      <?php
        $today  = new DateTime('today');
        $now    = new DateTime(); // current date + time
        foreach ($list as $r):
          // Format date & time
          $dStr = date('M d, Y', strtotime($r['appt_date']));
          $tStr = date('g:i A',      strtotime($r['slot']));

          // Determine visual status. If it's still "booked" but in the past, show "Expired".
          $status = strtolower($r['status']);
          $badge  = $status; // default class matches status

          // Build DateTime for the appointment moment
          $apptDT = DateTime::createFromFormat('Y-m-d H:i', $r['appt_date'].' '.$r['slot']);
          if ($status === 'booked' && $apptDT < $now) {
              $badge  = 'expired';
              $status = 'expired';
          }
      ?>
      <tr>
        <td class="when"><?=$dStr?> • <?=$tStr?></td>
        <td class="where"><strong><?=htmlspecialchars($r['vet_name'])?></strong> (<?=htmlspecialchars($r['vet_city'])?>)</td>
        <td class="pet"><?=htmlspecialchars($r['pet_name'])?></td>
        <td><span class="badge <?=$badge?>"><?=ucfirst($status)?></span></td>
        <td class="note"><?=htmlspecialchars($r['notes'] ?: '—')?></td>
      </tr>
      <?php endforeach; ?>
    </tbody>
  </table>

<?php endif; ?>
</div>
</body></html>


===== FILE: app\views\appointment\index.php =====
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Find a Vet • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --brand:#26c1a8; --brand2:#1ea893;
  --ink:#163c35; --muted:#6c7e7b;
  --bg:#f0faf6; --card:#ffffff; --line:#e9e7e6; --danger:#ff6b6b;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);color:var(--ink);padding:40px 6%}

/* hero */
.hero{max-width:1180px;margin:92px auto 24px;display:grid;grid-template-columns:1.1fr .9fr;gap:28px;align-items:center}
@media (max-width:980px){.hero{grid-template-columns:1fr}}
h1{font-size:2.4rem;line-height:1.15;margin-bottom:10px}
.lead{color:var(--muted)}
.hero-pic{width:100%;aspect-ratio:4/3;border-radius:24px;overflow:hidden;background:#eaf8f5;box-shadow:0 18px 26px rgba(0,0,0,.10)}
.hero-pic img{width:100%;height:100%;object-fit:cover;display:block}

/* search bar */
.formbar{margin-top:16px;display:flex;gap:10px}
.formbar input{flex:1;padding:1rem;border:2px solid var(--line);border-radius:14px;background:#fff}
.formbar input:focus{outline:none;border-color:var(--brand)}
.formbar button{padding:1rem 1.2rem;border:none;border-radius:14px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer}
.formbar button:hover{background:var(--brand2)}

/* helpline + 24/7 */
.info-strip{max-width:1180px;margin:6px auto 18px;display:grid;grid-template-columns:2fr 1fr;gap:14px}
@media (max-width:980px){.info-strip{grid-template-columns:1fr}}
.tile{background:#fff;border:1px solid var(--line);border-radius:14px;padding:14px;box-shadow:0 10px 18px rgba(0,0,0,.06)}
.tile h3{font-size:1.1rem;margin-bottom:6px}
.small{color:#6b7a77;font-size:.92rem}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem;margin-right:6px;border:1px solid #bfece1;background:#e7f8f4;color:#1b907d}
.badge.red{border-color:#ffc3c3;background:#ffe9e9;color:#c43a3a}

/* count + chip */
.bar{max-width:1180px;margin:6px auto 10px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px}
.count{color:var(--muted)}
.chip{display:inline-flex;align-items:center;gap:6px;background:#e7f8f4;border:1px solid #bfece1;color:#1b907d;padding:6px 10px;border-radius:999px;font-weight:700;font-size:.85rem}

/* vet grid */
.grid{max-width:1180px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:18px}
.card{background:#fff;border:1px solid var(--line);border-radius:16px;overflow:hidden;box-shadow:0 10px 20px rgba(0,0,0,.06)}
.thumb{width:100%;aspect-ratio:16/10;background:#f6f8f8}
.thumb img{width:100%;height:100%;object-fit:cover;display:block}
.b{padding:14px 16px}
.name{font-weight:700}
.meta{color:#4c5e5b;font-size:.93rem;margin-top:6px}
.btn{display:block;margin-top:12px;text-align:center;background:var(--brand);color:#fff;text-decoration:none;font-weight:700;padding:11px;border-radius:12px}
.btn:hover{background:var(--brand2)}
.tag247{margin-left:8px}
.empty{max-width:800px;margin:18px auto;background:#fff;border:1px dashed var(--line);border-radius:14px;padding:16px;text-align:center;color:#60706d}
</style>
</head>
<body>
<?php include_once 'app/views/partials/nav.php'; ?>

<section class="hero">
  <div>
    <h1>Pet Clinic</h1>
    <p class="lead">Search vets near you, see who’s <b>open 24/7</b>, call the online helpline, and book a slot.</p>
    <form class="formbar" method="GET" action="<?=BASE_URL?>/Appointment/index">
      <input type="text" name="location" value="<?=htmlspecialchars($location ?? '')?>" placeholder="Search by city or area (e.g., Dhaka)" aria-label="Search location">
      <button type="submit">Find Vets</button>
    </form>
  </div>
  <figure class="hero-pic">
    <img src="https://www.waterwayanimalhospital.com/wp-content/uploads/sites/357/2022/12/AdobeStock_287230497-scaled.jpeg" alt="Happy dog at the clinic">
  </figure>
</section>

<?php
  // Compute 24/7 clinics from the search result (works if your vets table has `hours` like "24/7"
  // or a boolean column `is_24_7` = 1. If missing, nothing breaks.)
  $open247 = array_values(array_filter($vets ?? [], function($v){
      if (isset($v['is_24_7']) && (int)$v['is_24_7']===1) return true;
      if (!empty($v['hours']) && stripos($v['hours'],'24/7')!==false) return true;
      return false;
  }));
?>

<section class="info-strip">
  <div class="tile">
    <h3>📞 Online Helpline</h3>
    <div class="small">We’re here to guide you to an available vet and answer quick questions.</div>
    <div style="margin-top:8px;font-weight:700;font-size:1.05rem">
      <a href="tel:+880170000000" style="color:var(--brand);text-decoration:none">+880 1700-000000</a>
      <span class="badge">24/7</span>
    </div>
  </div>

  <div class="tile">
    <h3>🏥 24/7 Clinics<?= $location ? " near “".htmlspecialchars($location)."”" : "" ?></h3>
    <?php if ($open247): ?>
      <div class="small">
        <?php foreach($open247 as $i=>$c): ?>
          <span class="badge"><?=htmlspecialchars($c['name'])?></span>
        <?php endforeach; ?>
      </div>
    <?php else: ?>
      <div class="small">No specific 24/7 clinic in this search. Call the helpline for immediate assistance.</div>
    <?php endif; ?>
  </div>
</section>

<section class="bar">
  <?php $count = count($vets ?? []); ?>
  <div class="count">Showing <b><?=$count?></b> vet<?=($count==1?'':'s')?><?= $location ? " near “".htmlspecialchars($location)."”" : "" ?>.</div>
  <?php if(!empty($location)): ?><div class="chip">📍 <?=htmlspecialchars($location)?></div><?php endif; ?>
</section>

<?php if(!$vets): ?>
  <div class="empty">No vets found. Try a nearby city or a shorter search.</div>
<?php endif; ?>

<section class="grid">
  <?php
    $placeholder='https://www.waterwayanimalhospital.com/wp-content/uploads/sites/357/2022/12/AdobeStock_287230497-scaled.jpeg';
    foreach($vets as $v):
      $img = $v['photo'] ?: $placeholder;
      $is247 = (isset($v['is_24_7']) && (int)$v['is_24_7']===1) || (!empty($v['hours']) && stripos($v['hours'],'24/7')!==false);
  ?>
  <article class="card">
    <div class="thumb"><img src="<?=htmlspecialchars($img)?>" alt="<?=htmlspecialchars($v['name'])?>" onerror="this.src='<?=htmlspecialchars($placeholder)?>'"></div>
    <div class="b">
      <div class="name"><?=htmlspecialchars($v['name'])?> <?php if($is247): ?><span class="badge tag247">24/7</span><?php endif; ?></div>
      <div class="meta">📍 <?=htmlspecialchars($v['city'])?> — <?=htmlspecialchars($v['address'])?></div>
      <?php if(!empty($v['phone'])): ?><div class="meta">☎️ <?=htmlspecialchars($v['phone'])?></div><?php endif; ?>
      <?php if(!empty($v['hours'])): ?><div class="small" style="margin-top:4px">Hours: <?=htmlspecialchars($v['hours'])?></div><?php endif; ?>
      <a class="btn" href="<?=BASE_URL?>/Appointment/book?vet_id=<?=$v['id']?>">View Available Slots</a>
    </div>
  </article>
  <?php endforeach; ?>
</section>

</body>
</html>


===== FILE: app\views\appointment\thanks.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Appointment Confirmed • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{--brand:#26c1a8;--bg:#f0faf6;--card:#fff}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);padding:40px 6%}
.card{max-width:760px;margin:110px auto;background:var(--card);border-radius:18px;box-shadow:0 10px 22px rgba(0,0,0,.08);padding:28px;text-align:center}
h1{font-size:1.9rem;margin-bottom:8px}
p{color:#555}
.badge{display:inline-block;margin-top:10px;background:#e7f8f4;border:1px solid #bfece1;color:#1b907d;padding:8px 14px;border-radius:999px;font-weight:700}
a.btn{display:inline-block;margin-top:16px;padding:11px 16px;background:var(--brand);color:#fff;text-decoration:none;border-radius:12px;font-weight:700}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>
<div class="card">
  <h1>Appointment Confirmed 🎉</h1>
  <p>We booked <b><?=htmlspecialchars($a['pet_name'])?></b> with <b><?=htmlspecialchars($a['vet_name'])?></b> in <b><?=htmlspecialchars($a['vet_city'])?></b>.</p>
  <div class="badge"><?=htmlspecialchars($a['appt_date'])?> at <?=htmlspecialchars($a['slot'])?></div>
  <p style="margin-top:12px">You can view your upcoming and past bookings anytime.</p>
  <a class="btn" href="<?=BASE_URL?>/Appointment/history">View Appointment History</a>
</div>
</body></html>


===== FILE: app\views\cart\checkout.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Checkout • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;display:flex;justify-content:center;align-items:center;min-height:100vh;padding:1rem}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);width:460px;padding:36px}
h2{color:#41403e;font-size:1.6rem;font-weight:600;margin-bottom:1.1rem;text-align:center}
label{display:block;font-weight:600;color:#41403e;margin-top:14px;font-size:.95rem}
input,textarea{width:100%;padding:.75rem 1rem;border:2px solid #e9e7e6;border-radius:10px;margin-top:.35rem;font-size:.9rem}
input:focus,textarea:focus{border-color:#26c1a8;outline:none}
.item-summary{background:#fafafa;border:1px solid #e0dedc;border-radius:10px;padding:12px;margin-top:10px;font-size:.9rem;color:#555;line-height:1.4}
.item-summary-title{font-weight:700;color:#41403e;margin-top:14px;font-size:.95rem}
.total{margin-top:18px;font-weight:700;color:#ff8552;font-size:1.05rem;text-align:right}
button{margin-top:22px;background:#26c1a8;color:#fff;border:none;width:100%;padding:.9rem;font-weight:600;font-size:1rem;border-radius:10px;cursor:pointer;transition:.3s}
button:hover{background:#1ea893}
</style></head><body>


<div class="card" style="margin-top:80px">
  <h2>Delivery Details</h2>

  <!-- 🐾 Order items heading -->
  <div class="item-summary-title">Order Items</div>
  <div class="item-summary">
    <?php foreach($items as $i): ?>
        • <?=htmlspecialchars($i['name'])?> — <?=$i['qty']?> item(s)<br>
    <?php endforeach;?>
  </div>

  <form method="POST">
      <label>Name</label>
      <input type="text" name="customer" required>

      <label>Address</label>
      <textarea name="address" rows="3" required></textarea>

      <label>Contact&nbsp;No.</label>
      <input type="text" name="contact" required>

      <div class="total">Total&nbsp;$<?=number_format($total,2)?></div>

      <button type="submit">Confirm Order</button>
  </form>
</div>
</body></html>


===== FILE: app\views\cart\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Your Cart • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{text-align:center;font-size:2rem;font-weight:600;color:#41403e;margin:90px 0 1.6rem}
table{width:100%;background:#fff;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.9rem}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
.total{font-weight:700;color:#ff8552;text-align:right;padding-top:18px}
a.btn{display:inline-block;background:#26c1a8;color:#fff;text-decoration:none;padding:12px 28px;border-radius:10px;font-weight:600;margin-top:20px}
a.btn:hover{background:#1ea893}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>Your Cart</h1>

<?php if(!$data['items']): ?>
   <p style="text-align:center;color:#555">Your cart is empty.</p>
<?php else: ?>
<table>
<thead><tr><th>Product</th><th>Qty</th><th>Price</th><th>Line</th><th></th></tr></thead>
<tbody>
   <?php foreach($data['items'] as $i): ?>
      <tr>
        <td><?=htmlspecialchars($i['name'])?></td>
        <td><?=$i['qty']?></td>
        <td>$<?=number_format($i['price'],2)?></td>
        <td>$<?=number_format($i['line'],2)?></td>
        <td><a style="color:#ff8552;text-decoration:none;font-weight:600" href="<?=BASE_URL?>/Cart/remove?id=<?=$i['id']?>">Remove</a></td>
      </tr>
   <?php endforeach;?>
</tbody>
</table>

<div class="total">Total  $<?=number_format($data['total'],2)?></div>
<div style="text-align:right"><<a class="btn" href="<?=BASE_URL?>/Cart/checkout">Checkout</a></div>
<?php endif;?>
</body></html>


===== FILE: app\views\donation\give.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>Make a Donation • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px 6%}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);padding:26px 28px;max-width:680px;margin:80px auto 20px}
h1{font-size:1.6rem;font-weight:600;color:#41403e;margin-bottom:12px}
label{display:block;font-weight:600;color:#41403e;margin-top:14px;font-size:.95rem}
input,textarea,select{width:100%;padding:.75rem 1rem;border:2px solid #e9e7e6;border-radius:10px;margin-top:.35rem;font-size:.9rem}
input:focus,textarea:focus,select:focus{border-color:#26c1a8;outline:none}
button{margin-top:18px;background:#26c1a8;color:#fff;border:none;width:100%;padding:.9rem;font-weight:600;font-size:1rem;border-radius:10px;cursor:pointer;transition:.3s}
button:hover{background:#1ea893}
.small{color:#777;font-size:.85rem;margin-top:10px}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<div class="card">
  <h1>Make a Donation</h1>
  <form method="POST" action="<?=BASE_URL?>/Donation/submit">
    <label>Your Name</label>
    <input type="text" name="name" value="<?=htmlspecialchars($username)?>" placeholder="Optional">

    <label>Email</label>
    <input type="email" name="email" value="<?=htmlspecialchars($email)?>" placeholder="Optional (for receipt)">

    <label>Choose Shelter</label>
    <select name="shelter_id" required>
      <option value="">-- Select a shelter --</option>
      <?php foreach($shelters as $s): ?>
        <option value="<?=$s['id']?>"><?=htmlspecialchars($s['name'])?></option>
      <?php endforeach; ?>
    </select>

    <label>Amount (USD)</label>
    <input type="number" name="amount" step="0.01" min="1" required>

    <label>Message (optional)</label>
    <textarea name="note" rows="3" placeholder="Send a little love note to the shelter 💚"></textarea>

    <button type="submit">Donate Now</button>
  </form>
  <div class="small">Your donation goes directly to the selected registered shelter.</div>
</div>
</body></html>


===== FILE: app\views\donation\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>Donate • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6}

/* hero with soft overlay image (keeps theme colors) */
.hero{
  position:relative; height:60vh; min-height:360px; margin-top:10px;
  background:url("https://petfriendlyservices.org/wp-content/uploads/Dog-Cat-Blanket-2500x800-1.jpg") center/cover no-repeat;
  display:flex;align-items:center;justify-content:center
}
.hero::before{content:'';position:absolute;inset:0;background:rgba(0,0,0,.35)}
.hero-inner{position:relative;text-align:center;color:#fff;padding:0 1rem;max-width:900px}
.hero-inner h1{font-size:2.2rem;font-weight:700;margin-bottom:.6rem}
.hero-inner p{font-size:1rem;line-height:1.6}
.hero-inner em{color:#bdf0e7;font-style:normal}

/* content */
.wrap{padding:28px 6%}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);padding:26px 28px;margin:auto;max-width:1020px}
h2{font-size:1.5rem;color:#41403e;font-weight:600;margin-bottom:10px}
p{color:#555;line-height:1.45;font-size:.95rem;margin-bottom:10px}
ul{margin:8px 0 0 18px;color:#555;line-height:1.45;font-size:.95rem}

/* two-column info + image */
.two{display:grid;grid-template-columns:1.1fr .9fr;gap:22px;align-items:center}
.side-img{width:100%;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);object-fit:cover}

/* stats */
.stats{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:16px}
.stat{background:#fafafa;border:1px solid #e0dedc;border-radius:12px;padding:14px;text-align:center}
.stat .num{font-weight:700;color:#ff8552;font-size:1.2rem}
.stat .lbl{color:#41403e;font-weight:600;margin-top:4px}

/* button */
.cta{margin-top:18px;text-align:center}
a.btn{
  display:inline-block;background:#26c1a8;color:#fff;text-decoration:none;
  padding:14px 34px;border-radius:12px;font-weight:600
}
a.btn:hover{background:#1ea893}

@media(max-width:920px){.two{grid-template-columns:1fr}.hero{height:46vh}}
@media(max-width:520px){.stats{grid-template-columns:1fr}}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<section class="hero">
  <div class="hero-inner">
    <h1>Donate</h1>
    <p><em>“They can’t ask for help, but their eyes tell the story. Be the reason their tail wags again.”</em></p>
  </div>
</section>

<div class="wrap">
  <div class="card">
    <div class="two">
      <div>
        <h2>Donate To Our Animal Shelter Partners</h2>
        <p>
          At PawCare, your generosity supports <b>registered shelters</b> that rescue, vaccinate,
          and foster cats and dogs. We keep things simple and transparent so your gift goes where
          it matters most: <b>belly rubs, full bowls, and safe snoozes</b>.
        </p>
        <ul>
          <li>We forward your donation directly to the shelter you select.</li>
          <li>Funds help with food, medicine, vaccinations, and foster home care.</li>
          <li>We track totals publicly—because every wag and purr deserves honesty.</li>
        </ul>

        <div class="stats">
          <div class="stat">
            <div class="num"><?=$stats['donors']?></div>
            <div class="lbl">Donors so far</div>
          </div>
          <div class="stat">
            <div class="num">$<?=number_format($stats['total'],2)?></div>
            <div class="lbl">Total raised</div>
          </div>
          <div class="stat">
            <div class="num"><?=$stats['donations']?></div>
            <div class="lbl">Donations</div>
          </div>
        </div>

        <div class="cta">
          <a href="<?=BASE_URL?>/Donation/give" class="btn">Donate now</a>
        </div>
      </div>

      <!-- friendly pet photo -->
      <img class="side-img" src="https://images.unsplash.com/photo-1543852786-1cf6624b9987?auto=format&fit=crop&w=900&q=80" alt="Happy cat and dog">
    </div>
  </div>
</div>
</body></html>


===== FILE: app\views\donation\thanks.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>Thank You • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6}

/* layout */
.wrap{padding:40px 6%}
.card{
  background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);
  padding:26px 28px;max-width:980px;margin:80px auto 24px
}
.grid{display:grid;grid-template-columns:1fr 1.1fr;gap:24px;align-items:center}
@media(max-width:860px){.grid{grid-template-columns:1fr}}

/* image side */
.pic{
  position:relative;display:flex;align-items:center;justify-content:center
}
.pic img{
  width:100%;max-width:380px;height:340px;object-fit:cover;border-radius:16px;
  box-shadow:0 8px 18px rgba(0,0,0,.08)
}
.badge{
  position:absolute;bottom:-12px;left:50%;transform:translateX(-50%);
  background:#26c1a8;color:#fff;padding:8px 16px;border-radius:999px;
  font-weight:700;box-shadow:0 6px 14px rgba(0,0,0,.08)
}

/* text side */
h1{color:#41403e;font-size:1.8rem;font-weight:600;margin-bottom:.6rem}
p{color:#555;line-height:1.5;margin-bottom:10px}
.info{background:#fafafa;border:1px solid #e0dedc;border-radius:12px;padding:12px 14px;margin:10px 0}
.row{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
a.btn{
  display:inline-block;text-decoration:none;font-weight:600;border-radius:12px;
  padding:12px 24px
}
.btn-primary{background:#26c1a8;color:#fff}
.btn-primary:hover{background:#1ea893}
.btn-ghost{border:2px solid #26c1a8;color:#26c1a8;background:transparent}
.btn-ghost:hover{background:#e7f8f4}
.small{color:#777;font-size:.9rem;margin-top:8px}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<?php
  $shelter = htmlspecialchars($donation['shelter_name'] ?? 'the shelter');
  $amount  = number_format($donation['amount'] ?? 0, 2);
  $when    = isset($donation['created']) ? date('M j, Y • H:i', strtotime($donation['created'])) : '';
  $id      = $donation['id'] ?? null;
?>

<div class="wrap">
  <div class="card">
    <div class="grid">
      <!-- Image + amount badge -->
      <div class="pic">
        <img src="https://as1.ftcdn.net/v2/jpg/09/13/79/82/1000_F_913798269_4INTAQy7HdwL16cE5FbLPNEXbE8YpStX.jpg"
             alt="Happy dog and cat celebrating a donation">
        <div class="badge">+$<?=$amount?></div>
      </div>

      <!-- Text -->
      <div>
        <h1>Tail-wag alert! You just made a pet’s day 🐾</h1>
        <p>
          Thank you for donating <b>$<?=$amount?></b> to <b><?=$shelter?></b>.
          Your kindness helps with food, medicine, safe foster care—and lots of happy zoomies.
        </p>

        <div class="info">
          <?php if($id): ?><div class="small">Donation ID: <b>#<?=$id?></b></div><?php endif; ?>
          <?php if($when): ?><div class="small">Date: <b><?=$when?></b></div><?php endif; ?>
        </div>

        <div class="row">
          <a href="<?=BASE_URL?>/Pet/index" class="btn btn-primary">Meet the Pets</a>
          <a href="<?=BASE_URL?>/Donation/give" class="btn btn-ghost">Donate Again</a>
        </div>
        <p class="small">Every gift matters. Thanks for being the human behind a happy tail. 💚</p>
      </div>
    </div>
  </div>
</div>
</body></html>


===== FILE: app\views\orders\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>My Orders • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
h1{text-align:center;font-size:2rem;font-weight:600;color:#41403e;margin:90px 0 1.6rem}
table{width:100%;background:#fff;border-collapse:collapse;border-radius:12px;overflow:hidden;box-shadow:0 6px 15px rgba(0,0,0,.08)}
th,td{padding:14px 16px;font-size:.9rem}
th{background:#26c1a8;color:#fff;text-align:left}
tr:nth-child(even){background:#fafafa}
.empty{color:#555;text-align:center;margin-top:40px}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>My Orders</h1>

<?php if(!$orders): ?>
   <p class="empty">You haven’t placed any orders yet.</p>
<?php else: ?>
<table>
+ <thead><tr><th>ID</th><th>Date</th><th>Items</th><th>Total</th><th>Status</th></tr></thead>

<tbody>
<?php foreach($orders as $o): ?>
   <tr>
      <td><?=$o['id']?></td>
      <td><?=date('Y-m-d H:i', strtotime($o['created']))?></td>
      <td><?=htmlspecialchars($o['items'])?></td>
       <td>$<?=number_format($o['total'],2)?></td>
   <td><?=$o['status']?></td>
   </tr>
<?php endforeach;?>
</tbody>
</table>
<?php endif;?>
</body></html>


===== FILE: app\views\partials\nav.php =====
<?php
/* Nav bar (theme-friendly) + Vaccination "today" notifier */

if (session_status() === PHP_SESSION_NONE) { session_start(); }
require_once __DIR__ . '/../../../config.php';

/* --- Vaccination bell flag (simple & fast) --- */
$hasTodayVaccination = false;
if (!empty($_SESSION['user_id'])) {
    // lightweight direct query using the existing Database base class
    require_once __DIR__ . '/../../../core/Database.php';
    class _MiniDB extends Database { public function p(){ return $this->pdo; } }
    $db = (new _MiniDB())->p();

    $q = $db->prepare("
        SELECT 1
          FROM vaccinations
         WHERE user_id = ?
           AND status <> 'done'
           AND due_date = CURDATE()
         LIMIT 1
    ");
    $q->execute([$_SESSION['user_id']]);
    $hasTodayVaccination = (bool)$q->fetchColumn();
}

$user   = $_SESSION['user']    ?? null;
$role   = $_SESSION['role']    ?? 'guest';
$isAuth = !empty($_SESSION['user_id']);

/* Helper: hide some menu items for admin per your earlier rule */
$hideShopPetsDonateForAdmin = ($role === 'admin');

/* Cart count (sum quantities) */
$cartCount = 0;
if (!empty($_SESSION['cart']) && is_array($_SESSION['cart'])) {
    foreach ($_SESSION['cart'] as $qty) { $cartCount += (int)$qty; }
}
?>
<style>
/* keep your theme: Quicksand, mint accents, rounded pills */
.navbar{
  position:sticky; top:0; z-index:999;
  background:#ffffff; border-bottom:1px solid #e9e7e6;
  padding:10px 6%; display:flex; align-items:center; gap:18px;
  font-family:'Quicksand',sans-serif;
}
.nav-brand{
  font-weight:800; color:#26c1a8; text-decoration:none; font-size:1.2rem;
  padding:8px 12px; border-radius:10px;
}
.nav-links{ display:flex; gap:12px; align-items:center; margin-left:8px; flex-wrap:wrap }
.nav-links a{
  color:#214a44; text-decoration:none; padding:8px 12px;
  border-radius:10px; transition:background .2s;
}
.nav-links a:hover{ background:#eaf8f5 }
.nav-right{ margin-left:auto; display:flex; align-items:center; gap:10px }

/* Bell button */
.bell{
  position:relative; display:inline-flex; align-items:center; justify-content:center;
  width:40px; height:40px; border-radius:10px; border:1px solid #e9e7e6; background:#fff;
  cursor:pointer; text-decoration:none;
}
.bell:hover{ background:#f6fbfa }
.bell svg{ width:20px; height:20px; fill:#214a44 }
.bell-dot{
  position:absolute; top:6px; right:6px;
  width:10px; height:10px; border-radius:50%;
  background:#ff4d4f; box-shadow:0 0 0 2px #fff;
}
.btn{
  background:#26c1a8; color:#fff; text-decoration:none; padding:8px 14px;
  border-radius:10px; font-weight:700;
}
.btn:hover{ background:#1ea893 }
.avatar{
  display:inline-flex; width:36px; height:36px; border-radius:50%;
  background:#eaf8f5; border:2px solid #d6f2ea; color:#26c1a8;
  align-items:center; justify-content:center; font-weight:800;
}
</style>

<nav class="navbar">
  <!-- Brand takes user to Welcome page -->
  <a class="nav-brand" href="<?=BASE_URL?>/User/welcome">PawCare</a>

  <div class="nav-links">
    <?php if (!$hideShopPetsDonateForAdmin): ?>
      <a href="<?=BASE_URL?>/Pet/index">Pets</a>
      <a href="<?=BASE_URL?>/Shop/index">Shop</a>
      <a href="<?=BASE_URL?>/Donation/index">Donate</a>
      <a href="<?=BASE_URL?>/Appointment/index">Find A Vet</a>
    <?php endif; ?>
    <!-- Renamed label only -->

    <?php if (!$hideShopPetsDonateForAdmin): ?>
      <?php if ($isAuth): ?>
        <!-- My Orders (user only) -->
        <a href="<?=BASE_URL?>/Order/index">My Orders</a>
      <?php endif; ?>
      <!-- Cart with count (user-facing navbar) -->
      <a href="<?=BASE_URL?>/Cart/index">Cart (<?=$cartCount?>)</a>
    <?php endif; ?>

    <?php if ($role === 'admin'): ?>
      <!-- Admin menu (keeps your existing admin pages) -->
      <a href="<?=BASE_URL?>/Admin/index">Admin Products</a>
      <a href="<?=BASE_URL?>/AdminPet/index">Admin Pets</a>
      <a href="<?=BASE_URL?>/AdminAdoption/index">AdoptionInfo</a>
      <a href="<?=BASE_URL?>/AdminDonation/index">Admin Donations</a>
      <a href="<?=BASE_URL?>/AdminOrder/index">Admin Orders</a>
      <a href="<?=BASE_URL?>/AdminRehome/index">Admin Rehomes</a>
    <?php endif; ?>
  </div>

  <div class="nav-right">
    <!-- Vaccination notification bell -->
    <a class="bell" href="<?=BASE_URL?>/Vaccination/index"
       title="<?= $hasTodayVaccination ? 'Vaccinations due today!' : 'Vaccination reminders' ?>"
       aria-label="<?= $hasTodayVaccination ? 'Vaccinations due today!' : 'Vaccination reminders' ?>">
      <!-- simple bell icon (SVG) to match theme -->
      <svg viewBox="0 0 24 24" aria-hidden="true">
        <path d="M12 22a2.2 2.2 0 0 0 2.2-2.2H9.8A2.2 2.2 0 0 0 12 22Zm8-6v-5.5A6 6 0 0 0 13 4.1V3a1 1 0 1 0-2 0v1.1A6 6 0 0 0 4 10.5V16l-1.7 1.7A1 1 0 0 0 3 19h18a1 1 0 0 0 .7-1.7L20 16Z"/>
      </svg>
      <?php if ($hasTodayVaccination): ?>
        <span class="bell-dot" aria-hidden="true"></span>
      <?php endif; ?>
    </a>

    <?php if ($isAuth): ?>
      <a class="avatar" href="<?=BASE_URL?>/User/profile"><?=strtoupper(substr($user ?? 'U',0,1))?></a>
      <a class="btn" href="<?=BASE_URL?>/User/logout">Logout</a>
    <?php else: ?>
      <a href="<?=BASE_URL?>/User/login">Login</a>
      <a class="btn" href="<?=BASE_URL?>/User/register">Sign up</a>
    <?php endif; ?>
  </div>
</nav>


===== FILE: app\views\pet\detail.php =====

<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title><?=htmlspecialchars($pet['name'])?> • Pet Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px 6%}
.card{
    max-width:880px;margin:auto;background:#fff;border-radius:16px;
    box-shadow:0 8px 18px rgba(0,0,0,.08);display:flex;overflow:hidden
}
.card img{width:50%;object-fit:cover}
.info{padding:36px;width:50%}
h2{font-size:1.8rem;font-weight:600;margin-bottom:10px;color:#41403e}
.item{margin-bottom:12px;font-size:.95rem;color:#555}
.label{font-weight:600;color:#41403e}
.status{margin-top:16px;display:inline-block;font-weight:600;padding:8px 14px;border-radius:8px;font-size:.9rem;color:#fff}
.adopted{background:#aaa}
.available{background:#26c1a8}
.story{white-space:pre-wrap;line-height:1.45;margin-top:6px;color:#555}
a.btn{display:inline-block;background:#26c1a8;color:#fff;text-decoration:none;padding:12px 22px;border-radius:10px;font-weight:600;margin-top:14px}
a.btn:hover{background:#1ea893}
@media(max-width:760px){.card{flex-direction:column}.card img,.info{width:100%}}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<div class="card" style="margin-top:90px">
    <img src="<?=htmlspecialchars($pet['image'])?>" alt="">
    <div class="info">
        <h2><?=htmlspecialchars($pet['name'])?></h2>

        <div class="item"><span class="label">Age:</span> <?=htmlspecialchars($pet['age'])?></div>
        <div class="item"><span class="label">Breed:</span> <?=htmlspecialchars($pet['breed'])?></div>
        <div class="item"><span class="label">Vaccinated:</span> <?=$pet['vaccinated'] ? 'Yes' : 'No'?></div>

        <div class="item"><span class="label">Location:</span> <?=htmlspecialchars($pet['location']) ?: '—'?></div>
        <div class="item"><span class="label">Phone:</span> <?=htmlspecialchars($pet['phone']) ?: '—'?></div>
        <div class="item"><span class="label">Email:</span> <?=htmlspecialchars($pet['email']) ?: '—'?></div>

        <div class="item">
            <span class="label">Story:</span>
            <div class="story"><?=nl2br(htmlspecialchars($pet['story']))?></div>
        </div>

        <div class="status <?=$pet['adopted'] ? 'adopted' : 'available'?>">
            <?=$pet['adopted'] ? 'Adopted' : 'Available'?>
        </div>

        <?php if(!$pet['adopted']): ?>
          <div>
            <a class="btn" href="<?=BASE_URL?>/Adoption/apply?pet_id=<?=$pet['id']?>">Adopt me</a>
          </div>
        <?php endif; ?>
    </div>
</div>
</body></html>


===== FILE: app\views\pet\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8">
<title>All Pets • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{ --brand:#26c1a8; --ink:#41403e; --muted:#777; --bg:#f0faf6; --card:#fff; --line:#e9e7e6; }
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);padding:40px 6%}
h1{font-size:2rem;font-weight:700;color:var(--ink);text-align:center;margin:90px 0 16px}

/* Tabs + search */
.bar{max-width:1100px;margin:0 auto 14px;display:flex;flex-wrap:wrap;gap:10px;align-items:center;justify-content:space-between}
.tabs{display:flex;gap:10px;flex-wrap:wrap}
.tab{display:inline-block;padding:8px 14px;border-radius:999px;border:2px solid var(--brand);color:var(--brand);text-decoration:none;font-weight:700}
.tab.active{background:var(--brand);color:#fff}
.search{display:flex;gap:8px;align-items:center}
.search input{width:260px;max-width:60vw;padding:.7rem 1rem;border:2px solid var(--line);border-radius:12px}
.search input:focus{outline:none;border-color:var(--brand)}
.search button{padding:.7rem 1rem;border:none;background:var(--brand);color:#fff;border-radius:12px;font-weight:700;cursor:pointer}
.counter{max-width:1100px;margin:6px auto 14px;color:var(--muted);font-size:.95rem}

/* grid */
.grid{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:16px}
.card{background:var(--card);border-radius:14px;box-shadow:0 6px 14px rgba(0,0,0,.08);overflow:hidden}
.card img{width:100%;height:170px;object-fit:cover}
.card .b{padding:12px 14px}
.card .name{font-weight:700;color:var(--ink)}
.meta{font-size:.9rem;color:#555;margin-top:4px}
.badge{display:inline-block;margin-top:8px;padding:3px 10px;border-radius:999px;font-weight:700;font-size:.78rem}
.avail{background:#e7f8f4;color:#1b907d;border:1px solid #bfece1}
.adopt{background:#ffe6e6;color:#9c2a2a;border:1px solid #ffb2b2}
.btn{display:block;text-align:center;margin:10px 0 2px;padding:8px 12px;background:var(--brand);color:#fff;text-decoration:none;border-radius:10px;font-weight:700}
.btn:hover{background:#1ea893}
.loc{color:#777;font-size:.85rem;margin-top:6px}
</style>
</head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<h1>Find Your New Best Friend</h1>

<?php
  $species  = $data['species']  ?? null;
  $location = $data['location'] ?? '';
  $q = urlencode($location);
  $link = function($sp) use($q){
    $base = BASE_URL.'/Pet/index';
    if ($sp)  return $base.'?species='.$sp.($q!=='' ? '&location='.$q : '');
    return $base.($q!=='' ? '?location='.$q : '');
  };
?>
<div class="bar">
  <div class="tabs">
    <a class="tab <?=(!$species?'active':'')?>" href="<?=$link(null)?>">All</a>
    <a class="tab <?=($species==='Dog'?'active':'')?>" href="<?=$link('Dog')?>">Dog</a>
    <a class="tab <?=($species==='Cat'?'active':'')?>" href="<?=$link('Cat')?>">Cat</a>
  </div>

  <form class="search" method="GET" action="<?=BASE_URL?>/Pet/index">
    <?php if($species): ?><input type="hidden" name="species" value="<?=$species?>"><?php endif;?>
    <input type="text" name="location" value="<?=htmlspecialchars($location)?>" placeholder="Search by location (e.g., Dhaka)">
    <button type="submit">Search</button>
  </form>
</div>

<div class="counter">
  <?php $count = count($data['pets']); ?>
  Showing <b><?=$count?></b> pet<?=$count==1?'':'s'?><?=$location ? " near “".htmlspecialchars($location)."”" : ""?><?=$species ? " in ".$species : ""?>.
</div>

<div class="grid">
<?php foreach($data['pets'] as $p): ?>
  <div class="card">
    <img src="<?=htmlspecialchars($p['image'])?>" alt="<?=htmlspecialchars($p['name'])?>">
    <div class="b">
      <div class="name"><?=htmlspecialchars($p['name'])?> • <?=htmlspecialchars($p['species'])?></div>
      <div class="meta"><?=htmlspecialchars($p['breed'])?> • <?=htmlspecialchars($p['age'])?></div>
      <div class="loc">📍 <?=htmlspecialchars($p['location'] ?: '—')?></div>
      <span class="badge <?=$p['adopted']?'adopt':'avail'?>"><?=$p['adopted']?'Adopted':'Available'?></span>
      <a class="btn" href="<?=BASE_URL?>/Pet/detail?id=<?=$p['id']?>">View</a>
    </div>
  </div>
<?php endforeach; ?>
</div>

</body></html>


===== FILE: app\views\rehome\request.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>ReHome Your Pet • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px 6%}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);max-width:820px;margin:100px auto 24px;padding:28px}
h2{color:#41403e;font-size:1.6rem;font-weight:600;margin-bottom:8px;text-align:center}
p.lead{color:#555;text-align:center;margin-bottom:12px}
label{display:block;font-weight:600;color:#41403e;margin-top:14px}
input,select,textarea{width:100%;padding:.8rem 1rem;border:2px solid #e9e7e6;border-radius:10px;margin-top:.4rem;font-size:.95rem}
input:focus,select:focus,textarea:focus{border-color:#26c1a8;outline:none}
.row{display:flex;gap:12px;flex-wrap:wrap}
.col{flex:1 1 250px}
button{margin-top:18px;background:#26c1a8;color:#fff;border:none;width:100%;padding:.95rem;font-weight:700;border-radius:12px;cursor:pointer}
button:hover{background:#1ea893}
.box{background:#fafafa;border:1px dashed #e0dedc;border-radius:12px;padding:12px;margin-top:10px}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<div class="card">
  <h2>ReHome Your Pet</h2>
  <p class="lead">Tell us about your pet — we’ll review and add them to our adoption list after approval.</p>

  <form method="POST" action="<?=BASE_URL?>/Rehome/request">
    <div class="box">
      <div class="row">
        <div class="col">
          <label>Your Name</label>
          <input type="text" name="owner_name" value="<?=htmlspecialchars($u['username'] ?? '')?>" required>
        </div>
        <div class="col">
          <label>Your Email</label>
          <input type="email" name="owner_email" value="<?=htmlspecialchars($u['email'] ?? '')?>" required>
        </div>
      </div>
      <label>Phone</label>
      <input type="text" name="owner_phone" placeholder="+8801xxxxxxxxx">
      <label>Address (Foster / Pickup)</label>
      <input type="text" name="address" placeholder="House, Road, Area, City">
    </div>

    <label>Pet Name</label>
    <input type="text" name="name" required>

    <div class="row">
      <div class="col">
        <label>Species</label>
        <select name="species">
          <option value="Dog">Dog</option>
          <option value="Cat">Cat</option>
        </select>
      </div>
      <div class="col">
        <label>Age</label>
        <input type="text" name="age" placeholder="e.g., 2 years">
      </div>
      <div class="col">
        <label>Breed</label>
        <input type="text" name="breed" placeholder="e.g., Persian / Mixed">
      </div>
    </div>

    <label>Vaccinated</label>
    <select name="vaccinated">
      <option value="1">Yes</option>
      <option value="0">No</option>
    </select>

    <label>Photo URL</label>
    <input type="text" name="image" placeholder="https://...jpg" required>

    <label>Story / Notes</label>
    <textarea name="story" rows="4" placeholder="Temperament, likes, any special care"></textarea>

    <button type="submit">Submit ReHome Request</button>
  </form>
</div>
</body></html>


===== FILE: app\views\rehome\thanks.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>ReHome Request Sent • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6}
.wrap{padding:40px 6%}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);max-width:860px;margin:100px auto 24px;padding:28px;text-align:center}
h2{color:#41403e;font-size:1.7rem;font-weight:600;margin-bottom:8px}
p{color:#555}
a.btn{display:inline-block;margin-top:14px;padding:12px 22px;border-radius:12px;background:#26c1a8;color:#fff;text-decoration:none;font-weight:700}
a.btn:hover{background:#1ea893}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>
<div class="wrap">
  <div class="card">
    <h2>Thanks! We received your ReHome request 🐾</h2>
    <p>Our team will review your submission for <b><?=htmlspecialchars($r['name'])?></b> and get back to you.</p>
    <a class="btn" href="<?=BASE_URL?>/User/profile">Back to Profile</a>
  </div>
</div>
</body></html>


===== FILE: app\views\shop\detail.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Product • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --brand:#26c1a8; --brand2:#1ea893;
  --ink:#163c35; --muted:#6f7b78; --bg:#f0faf6; --line:#e9e7e6;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);color:var(--ink);padding:40px 6%}

.wrap{max-width:1100px;margin:92px auto 24px;display:grid;grid-template-columns:1fr 1fr;gap:28px}
@media(max-width:980px){.wrap{grid-template-columns:1fr}}

.gallery{background:#fff;border:1px solid var(--line);border-radius:16px;overflow:hidden;box-shadow:0 10px 20px rgba(0,0,0,.06)}
.gallery .pic{width:100%;height:420px;background:#f6f8f8}
.gallery img{width:100%;height:100%;object-fit:cover;display:block}

.panel{background:#fff;border:1px solid var(--line);border-radius:16px;padding:20px;box-shadow:0 10px 20px rgba(0,0,0,.06)}
h1{font-size:1.8rem;margin-bottom:6px}
.meta{color:var(--muted);margin-bottom:10px}
.price{font-size:1.6rem;font-weight:800;color:#1b3f39;margin:8px 0 12px}
.desc{color:#475a56;line-height:1.55;white-space:pre-wrap}

.actions{display:flex;gap:10px;margin-top:16px}
.qty{display:flex;gap:8px;align-items:center;border:2px solid var(--line);border-radius:12px;padding:6px 10px}
.qty input{width:64px;border:none;outline:none;font-weight:700}
.btn{flex:1;text-align:center;text-decoration:none;padding:.9rem 1rem;border-radius:12px;font-weight:700}
.btn-primary{background:var(--brand);color:#fff}
.btn-primary:hover{background:var(--brand2)}
.btn-ghost{border:2px solid var(--brand);color:var(--brand);background:#fff}
.btn-ghost:hover{background:#eaf8f5}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<?php $p = $data['prod']; ?>

<div class="wrap">
  <div class="gallery">
    <div class="pic">
      <img src="<?=htmlspecialchars($p['image'])?>" alt=""
           onerror="this.src='<?=BASE_URL?>/public/assets/images/product-placeholder.jpg'">
    </div>
  </div>

  <div class="panel">
    <h1><?=htmlspecialchars($p['name'])?></h1>
    <div class="meta"><?=htmlspecialchars($p['category'])?></div>
    <div class="price">$<?=number_format($p['price'],2)?></div>
    <div class="desc"><?=htmlspecialchars($p['description'])?></div>

    <div class="actions">
      <a class="btn btn-ghost" href="<?=BASE_URL?>/Shop/index">Back to shop</a>
      <form method="post" action="<?=BASE_URL?>/Cart/add?id=<?=$p['id']?>" style="flex:1;display:flex;gap:10px">
        <div class="qty">
          <label for="qty" style="font-weight:700;color:#1b3f39">Qty</label>
          <input id="qty" name="qty" type="number" value="1" min="1">
        </div>
        <button class="btn btn-primary" type="submit">Add to cart</button>
      </form>
    </div>
  </div>
</div>
</body></html>


===== FILE: app\views\shop\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>PawCare • Shop</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
:root{
  --brand:#26c1a8; --brand2:#1ea893;
  --ink:#163c35; --muted:#6f7b78;
  --bg:#f0faf6; --card:#ffffff; --line:#e9e7e6;
}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:var(--bg);color:var(--ink);padding:40px 6%}

/* hero */
.hero{max-width:1180px;margin:92px auto 22px;display:grid;grid-template-columns:1.15fr .85fr;gap:22px;align-items:center}
@media(max-width:980px){.hero{grid-template-columns:1fr}}
h1{font-size:2.2rem;line-height:1.2;margin-bottom:6px}
.lead{color:var(--muted)}
.hero-card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:20px;box-shadow:0 10px 20px rgba(0,0,0,.06)}
.hero-pic{height:220px;border-radius:16px;overflow:hidden;background:#eaf8f5;box-shadow:0 10px 20px rgba(0,0,0,.06)}
.hero-pic img{width:100%;height:100%;object-fit:cover;display:block}

/* toolbar */
.toolbar{max-width:1180px;margin:6px auto 18px;display:flex;flex-wrap:wrap;gap:10px;align-items:center}
.tab{display:inline-block;padding:8px 12px;border:1px solid #bfece1;background:#e7f8f4;color:#1b907d;border-radius:999px;font-weight:700;text-decoration:none}
.tab.active{background:var(--brand);border-color:var(--brand);color:#fff}
.search{margin-left:auto;display:flex;gap:8px}
.search input{padding:.75rem 1rem;border:2px solid var(--line);border-radius:12px;background:#fff;min-width:240px}
.search button{padding:.75rem 1rem;border:none;border-radius:12px;background:var(--brand);color:#fff;font-weight:700;cursor:pointer}
.search button:hover{background:var(--brand2)}
@media(max-width:720px){.search{width:100%}.search input{flex:1;min-width:0}}

/* grid */
.grid{max-width:1180px;margin:0 auto;display:grid;grid-template-columns:repeat(auto-fill,minmax(230px,1fr));gap:16px}
.card{background:#fff;border:1px solid var(--line);border-radius:16px;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 10px 20px rgba(0,0,0,.06);transition:transform .18s ease, box-shadow .18s ease}
.card:hover{transform:translateY(-3px);box-shadow:0 14px 24px rgba(0,0,0,.09)}
.thumb{width:100%;height:170px;background:#f6f8f8;position:relative}
.thumb img{width:100%;height:100%;object-fit:cover;display:block}
.badge{position:absolute;left:10px;top:10px;background:#fff;border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-weight:700;font-size:.78rem;color:#1b3f39}
.b{padding:14px 16px;display:flex;flex-direction:column;gap:8px}
.name{font-weight:700}
.cat{font-size:.85rem;color:#60706d}
.price-row{display:flex;align-items:center;justify-content:space-between}
.price{font-size:1.05rem;font-weight:800;color:#1b3f39}
.actions{margin-top:6px;display:flex;gap:10px}
.btn{flex:1;text-align:center;text-decoration:none;padding:.7rem;border-radius:12px;font-weight:700}
.btn-primary{background:var(--brand);color:#fff}
.btn-primary:hover{background:var(--brand2)}
.btn-ghost{border:2px solid var(--brand);color:var(--brand);background:#fff}
.btn-ghost:hover{background:#eaf8f5}

/* empty */
.empty{max-width:880px;margin:20px auto;background:#fff;border:1px dashed var(--line);border-radius:14px;padding:16px;text-align:center;color:#60706d}
</style>
</head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<section class="hero">
  <div class="hero-card">
    <h1>Pet Shop</h1>
    <p class="lead">Healthy food, playful toys, comfy accessories—everything your buddy loves, in one place.</p>
  </div>
  <figure class="hero-pic">
    <img src="https://www.shutterstock.com/image-photo/dog-cat-shopping-cart-on-600nw-2174056805.jpg"
         alt="" onerror="this.src='<?=BASE_URL?>/public/assets/images/shop-hero.jpg'">
  </figure>
</section>

<?php
  // Category tabs use existing ShopController index?cat=...
  $active = $data['cat'] ?? null;
  $mk = function($label,$cat) use($active){
    $is = ($active===$cat || ($cat===null && $active===null));
    $href = $cat ? BASE_URL.'/Shop/index?cat='.urlencode($cat) : BASE_URL.'/Shop/index';
    return '<a class="tab'.($is?' active':'').'" href="'.$href.'">'.($label).'</a>';
  };
?>
<div class="toolbar">
  <?=$mk('All', null)?>
  <?=$mk('Food', 'Food')?>
  <?=$mk('Medicine', 'Medicine')?>
  <?=$mk('Toy', 'Toy')?>
  <?=$mk('Accessories', 'Accessories')?>

  <!-- quick client-side filter by name -->
  <form class="search" onsubmit="event.preventDefault()">
    <input id="q" type="text" placeholder="Search product name...">
    <button onclick="filterCards()">Search</button>
  </form>
</div>

<?php if(empty($data['products'])): ?>
  <div class="empty">No products found in this category.</div>
<?php endif; ?>

<section id="grid" class="grid">
<?php foreach($data['products'] as $p): ?>
  <article class="card" data-name="<?=htmlspecialchars(strtolower($p['name']))?>">
    <div class="thumb">
      <img src="<?=htmlspecialchars($p['image'])?>" alt=""
           onerror="this.src='<?=BASE_URL?>/public/assets/images/product-placeholder.jpg'">
      <span class="badge"><?=htmlspecialchars($p['category'])?></span>
    </div>
    <div class="b">
      <div class="name"><?=htmlspecialchars($p['name'])?></div>
      <div class="price-row">
        <div class="cat">for happy pets</div>
        <div class="price">$<?=number_format($p['price'],2)?></div>
      </div>

      <div class="actions">
        <a class="btn btn-ghost" href="<?=BASE_URL?>/Shop/detail?id=<?=$p['id']?>">Details</a>
        <form method="post" action="<?=BASE_URL?>/Cart/add?id=<?=$p['id']?>" style="flex:1">
          <input type="hidden" name="qty" value="1">
          <button class="btn btn-primary" type="submit">Add to cart</button>
        </form>
      </div>
    </div>
  </article>
<?php endforeach; ?>
</section>

<script>
function filterCards(){
  const q = (document.getElementById('q').value || '').trim().toLowerCase();
  const items = document.querySelectorAll('#grid .card');
  items.forEach(el=>{
    const n = el.getAttribute('data-name');
    el.style.display = (!q || (n && n.indexOf(q)>-1)) ? '' : 'none';
  });
}
</script>
</body></html>


===== FILE: app\views\user\edit.php =====
<!-- FILE: app/views/user/edit.php -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Edit Profile • PawCare</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px 6%}
    .card{
      background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);
      max-width:720px;margin:100px auto;padding:28px
    }
    h2{color:#41403e;font-size:1.7rem;font-weight:600;margin-bottom:10px;text-align:center}
    label{display:block;font-weight:600;color:#41403e;margin-top:14px}
    input,textarea{
      width:100%;padding:.8rem 1rem;border:2px solid #e9e7e6;border-radius:12px;
      margin-top:.45rem;font-size:.95rem;background:#fff
    }
    textarea{min-height:110px}
    input:focus,textarea:focus{border-color:#26c1a8;outline:none}

    /* Primary submit */
    button[type="submit"]{
      margin-top:16px;background:#26c1a8;color:#fff;border:none;width:100%;
      padding:.95rem;font-weight:700;font-size:1rem;border-radius:12px;cursor:pointer;transition:.25s
    }
    button[type="submit"]:hover{background:#1ea893}

    /* Action row under the Save button */
    .actions{
      display:flex;gap:12px;margin-top:12px;
    }
    /* Use unique classes to avoid clashing with navbar .btn */
    .btn-outline{
      flex:1; display:inline-block; text-align:center; text-decoration:none;
      border:2px solid #26c1a8; color:#26c1a8; background:#fff;
      padding:12px 16px; border-radius:12px; font-weight:700;
      transition:background .2s, transform .05s;
    }
    .btn-outline:hover{background:#e7f8f4}
    .btn-outline:active{transform:translateY(1px)}

    .btn-orange{
      flex:1; display:inline-block; text-align:center; text-decoration:none;
      border:2px solid #ff8552; color:#ff8552; background:#fff;
      padding:12px 16px; border-radius:12px; font-weight:700;
      transition:background .2s, transform .05s;
    }
    .btn-orange:hover{background:#fff3ee}
    .btn-orange:active{transform:translateY(1px)}

    .small{color:#777;font-size:.88rem;margin-top:6px;text-align:center}

    @media(max-width:520px){
      .actions{flex-direction:column}
    }
  </style>
</head>
<body>
  <?php include_once 'app/views/partials/nav.php'; ?>

  <div class="card">
    <h2>Edit Profile</h2>

    <form method="POST" action="<?=BASE_URL?>/User/edit">
      <label>Name</label>
      <input type="text" name="username" value="<?=htmlspecialchars($u['username'])?>" required>

      <label>Email</label>
      <input type="email" name="email" value="<?=htmlspecialchars($u['email'])?>" required>

      <label>Phone</label>
      <input type="text" name="phone" placeholder="+8801xxxxxxxxx" value="<?=htmlspecialchars($u['phone'] ?? '')?>">

      <label>Address</label>
      <input type="text" name="address" placeholder="House, Road, Area, City" value="<?=htmlspecialchars($u['address'] ?? '')?>">

      <label>Short Bio</label>
      <textarea name="bio" placeholder="A few lines about you, your pets, experience, or preferences..."><?=htmlspecialchars($u['bio'] ?? '')?></textarea>

      <!-- Save -->
      <button type="submit">Save Changes</button>

      <!-- Clearly visible action buttons -->
      <div class="actions">
        <a class="btn-outline" href="<?=BASE_URL?>/User/profile">Cancel</a>
        <a class="btn-orange" href="<?=BASE_URL?>/Rehome/request">ReHome pet?</a>
      </div>

      <div class="small">Tip: Add your phone & address to speed up adoptions and deliveries.</div>
    </form>
  </div>
</body>
</html>


===== FILE: app\views\user\login.php =====
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PawCare • Log In</title>

    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">

    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family:'Quicksand',sans-serif;
            background:linear-gradient(135deg,#fff 0%,#f0faf6 100%);
            display:flex;justify-content:center;align-items:center;
            min-height:100vh;padding:1rem;
        }
        a{color:#26c1a8;text-decoration:none;font-size:0.9rem}
        a:hover{text-decoration:underline}

        .card{
            background:#ffffff;border-radius:18px;
            box-shadow:0 10px 25px rgba(0,0,0,0.08);
            display:flex;max-width:860px;overflow:hidden;width:100%;
        }
        .card img{width:50%;object-fit:cover}

        .form-wrap{
            padding:3rem 3.5rem;width:50%;
            display:flex;flex-direction:column;justify-content:center;
        }
        h1{color:#41403e;font-size:1.9rem;font-weight:600;margin-bottom:1.8rem;display:flex;gap:.5rem;align-items:center}
        h1 span{font-size:2rem}

        label{color:#41403e;font-weight:600;font-size:0.93rem;margin-bottom:.4rem;display:block}
        input{
            width:100%;padding:.8rem 1rem;margin-bottom:1.4rem;
            border:2px solid #e9e7e6;border-radius:10px;font-size:.95rem;transition:.25s border;
        }
        input:focus{border-color:#26c1a8;outline:none}

        button{
            background:#ff8552;color:#fff;border:none;width:100%;
            padding:.95rem;font-size:1rem;font-weight:600;border-radius:10px;
            cursor:pointer;transition:.3s background;
        }
        button:hover{background:#e4713f}

        .switch{margin-top:1.4rem;text-align:center;color:#666}

        @media(max-width:720px){
            .card{flex-direction:column;max-width:420px}
            .card img{display:none}
            .form-wrap{width:100%;padding:2.2rem}
        }
    </style>
</head>
<body>

    <div class="card">
        <!-- New cute cat photo -->
        <img src="https://img.freepik.com/free-photo/view-cats-dogs-being-friends_23-2151806276.jpg?semt=ais_hybrid&w=740" alt="Playful kitten">

        <div class="form-wrap">
            <h1><span>🐾</span>Welcome Back</h1>

            <form method="POST" action="">
                <label>Email</label>
                <input type="email" name="email" required>

                <label>Password</label>
                <input type="password" name="password" required>

                <button type="submit">Log In</button>
            </form>

            <p class="switch">
                Don’t have an account?
                <a href="<?php echo BASE_URL; ?>/User/register">Sign up</a>
            </p>
        </div>
    </div>
</body>
</html>


===== FILE: app\views\user\profile.php =====
<!DOCTYPE html>
<html lang="en"><head>
<meta charset="UTF-8"><title>PawCare • My Profile</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700;800&display=swap" rel="stylesheet">
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Quicksand',sans-serif;background:#f7fbfa;min-height:100vh}
  .card{background:#ffffff;border:1px solid #ebe9e7;border-radius:18px;box-shadow:0 10px 25px rgba(0,0,0,.05);
        max-width:820px;margin:26px auto;padding:18px}
  .avatar{width:88px;height:88px;border-radius:50%;background:#eaf8f5;border:2px solid #d6f2ea;
          display:flex;align-items:center;justify-content:center;font-weight:800;font-size:1.6rem;color:#26c1a8;margin-bottom:10px}
  .small{color:#6b7a78;margin-bottom:6px}
  .field{background:#fafafa;border:1px solid #e9e7e6;border-radius:12px;padding:10px 12px;margin-top:12px}
  .label{font-weight:700;color:#41403e;font-size:.9rem}
  .value{color:#555;margin-top:4px;white-space:pre-wrap}
  .bio{white-space:pre-wrap;line-height:1.45;color:#555}
  button.primary{margin-top:16px;background:#26c1a8;color:#fff;border:none;width:100%;
                 padding:.95rem;font-weight:700;font-size:1rem;border-radius:12px;cursor:pointer;transition:.25s}
  button.primary:hover{background:#1ea893}
  a.link{display:block;text-align:center;margin-top:10px;color:#26c1a8;text-decoration:none;font-weight:700}
  a.link:hover{text-decoration:underline}

  /* Appointments */
  .section-title{margin-top:18px;font-weight:700;color:#41403e}
  .appt-box{margin-top:8px;background:#fff;border:1px solid #e9e7e6;border-radius:12px}
  .appt-row{display:flex;gap:12px;align-items:center;padding:12px;border-top:1px solid #f1efee}
  .appt-row:first-child{border-top:none}
  .badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem}
  .booked{background:#e7f8f4;color:#1b907d;border:1px solid #bfece1}
  .completed{background:#e8eafc;color:#343a8b;border:1px solid #c7cbff}
  .cancelled{background:#ffe6e6;color:#9c2a2a;border:1px solid #ffb2b2}
  .when{min-width:160px;color:#1b3f39;font-weight:700}
  .who{color:#445b58}
  .empty{padding:14px;color:#60706d}

  .btn-cancel{margin-left:auto;background:#fff;border:2px solid #ff6b6b;color:#ff6b6b;
              padding:.55rem .8rem;border-radius:10px;font-weight:700;cursor:pointer}
  .btn-cancel:hover{background:#ffefef}
  .actions-row{display:flex;gap:10px;margin-top:10px}
  .btn-outline{display:inline-block;padding:.7rem 1rem;border:2px solid #26c1a8;color:#26c1a8;border-radius:12px;
               font-weight:700;text-decoration:none;text-align:center;flex:1}
  .btn-outline:hover{background:#eaf8f5}
</style>
</head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<?php
  // $u comes from UserController::profile
  // Load upcoming appointments and vaccination reminders (next 30 days)
  $apptUpcoming = $this->model('Appointment')->upcomingByUser($u['id'] ?? $_SESSION['user_id'] ?? 0, 6);
  $vaxSoon      = $this->model('Vaccination')->upcomingDue($u['id'] ?? $_SESSION['user_id'] ?? 0, 30, 5);
?>

<div class="card">
  <div class="avatar"><?=strtoupper(substr(($u['username'] ?? 'U'),0,1))?></div>
  <h2>Hello, <?=htmlspecialchars($u['username'])?> 👋</h2>
  <div class="small">Keep your info up to date so we can contact you about orders, adoptions, rehoming, or vet appointments.</div>

  <div class="field"><div class="label">Email</div><div class="value"><?=htmlspecialchars($u['email'] ?: '—')?></div></div>
  <div class="field"><div class="label">Phone</div><div class="value"><?=htmlspecialchars($u['phone'] ?: '—')?></div></div>
  <div class="field"><div class="label">Address</div><div class="value"><?=htmlspecialchars($u['address'] ?: '—')?></div></div>

  <div style="margin-top:14px">
    <div class="label" style="margin-bottom:6px">Bio</div>
    <div class="bio"><?=htmlspecialchars($u['bio'] ?: "Tell us about you! (e.g., favorite breed, pet experience)")?></div>
  </div>

  <!-- Vaccination reminders -->
  <div class="section-title">Vaccination reminders (next 30 days)</div>
  <div class="vax-box">
    <?php if(empty($vaxSoon)): ?>
      <div class="empty">No upcoming vaccinations. <a class="btn-outline" style="display:inline-block;margin-left:8px" href="<?=BASE_URL?>/Vaccination/index">Add one</a></div>
    <?php else: foreach($vaxSoon as $v): ?>
      <div class="row">
        <div class="when">📅 <?=date('M d, Y', strtotime($v['due_date']))?></div>
        <div class="who"><strong><?=htmlspecialchars($v['pet_name'])?></strong> – <?=htmlspecialchars($v['vaccine'])?> <?=($v['dose']?'('.htmlspecialchars($v['dose']).')':'')?></div>
        <span class="badge soon">Soon</span>
      </div>
    <?php endforeach; endif; ?>
  </div>

  <!-- Upcoming Appointments -->
  <div class="section-title">Upcoming appointments</div>
  <div class="appt-box">
    <?php if (!empty($apptUpcoming)): ?>
      <?php foreach ($apptUpcoming as $r): ?>
        <?php $d = date('M d, Y', strtotime($r['appt_date'])); $t = date('g:i A', strtotime($r['slot'])); ?>
        <div class="appt-row">
          <div class="when">🗓️ <?=$d?> • <?=$t?></div>
          <div class="who">with <strong><?=htmlspecialchars($r['vet_name'])?></strong> (<?=htmlspecialchars($r['vet_city'])?>) — for <strong><?=htmlspecialchars($r['pet_name'])?></strong></div>
          <span class="badge <?=htmlspecialchars(strtolower($r['status']))?>"><?=ucfirst($r['status'])?></span>

          <?php if (strtolower($r['status'])==='booked'): ?>
            <form method="post" action="<?=BASE_URL?>/Appointment/cancel" style="margin-left:auto">
              <input type="hidden" name="id" value="<?=$r['id']?>">
              <button class="btn-cancel" type="submit" onclick="return confirm('Cancel this appointment?')">Cancel</button>
            </form>
          <?php endif; ?>
        </div>
      <?php endforeach; ?>
    <?php else: ?>
      <div class="empty">No upcoming appointments. Book one now to see it here.</div>
    <?php endif; ?>
  </div>

  <div class="actions-row">
    <a class="btn-outline" href="<?=BASE_URL?>/Appointment/index">Book a Vet</a>
    <a class="btn-outline" href="<?=BASE_URL?>/Appointment/history">View All</a>
  </div>

  <form action="<?=BASE_URL?>/User/edit" method="get">
    <button class="primary" type="submit">Edit Profile</button>
  </form>

  <a class="link" href="<?=BASE_URL?>/Rehome/request">ReHome a pet?</a>
</div>
</body></html>


===== FILE: app\views\user\register.php =====
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PawCare • Sign Up</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">

    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family:'Quicksand',sans-serif;
            background:linear-gradient(135deg,#f0faf6 0%,#fff 100%);
            display:flex;justify-content:center;align-items:center;
            min-height:100vh;padding:1rem;
        }
        a{color:#ff8552;text-decoration:none;font-size:0.9rem}
        a:hover{text-decoration:underline}

        /* Card */
        .card{
            background:#ffffff;border-radius:18px;
            box-shadow:0 10px 25px rgba(0,0,0,0.08);
            display:flex;max-width:860px;overflow:hidden;width:100%;
        }
        .card img{width:50%;object-fit:cover}

        /* Form side */
        .form-wrap{
            padding:3rem 3.5rem;width:50%;
            display:flex;flex-direction:column;justify-content:center;
        }
        h1{color:#41403e;font-size:1.9rem;font-weight:600;margin-bottom:1.8rem;display:flex;gap:.5rem;align-items:center}
        h1 span{font-size:2rem}

        label{display:block;margin-bottom:.4rem;color:#41403e;font-weight:600;font-size:0.93rem}
        input{
            width:100%;padding:.8rem 1rem;margin-bottom:1.4rem;
            border:2px solid #e9e7e6;border-radius:10px;font-size:.95rem;transition:.25s border;
        }
        input:focus{border-color:#ff8552;outline:none}

        button{
            background:#26c1a8;color:#fff;border:none;width:100%;
            padding:.95rem;font-size:1rem;font-weight:600;border-radius:10px;
            cursor:pointer;transition:.3s background;
        }
        button:hover{background:#1ea893}

        .switch{margin-top:1.4rem;text-align:center;color:#666}

        @media(max-width:720px){
            .card{flex-direction:column;max-width:420px}
            .card img{display:none}
            .form-wrap{width:100%;padding:2.2rem}
        }
    </style>
</head>
<body>
    

    <div class="card">
        <!-- New cute dog photo -->
        <img src="https://i.ebayimg.com/images/g/9jkAAOSwjh5bIr7m/s-l1200.jpg" alt="Happy puppy">

        <div class="form-wrap">
            <h1><span>🐾</span>Create Account</h1>

            <form method="POST" action="">
                <label>Username</label>
                <input type="text" name="username" required>

                <label>Email</label>
                <input type="email" name="email" required>

                <label>Password</label>
                <input type="password" name="password" required>

                <button type="submit">Sign Up</button>
            </form>

            <p class="switch">
                Already have an account?
                <a href="<?php echo BASE_URL; ?>/User/login">Log in</a>
            </p>
        </div>
    </div>
</body>
</html>


===== FILE: app\views\user\welcome.php =====
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PawCare • Welcome</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0 }
    body {
      font-family: 'Quicksand', sans-serif;
      background: #f0faf6;
    }
    /* ─── Nav is included below ─── */

    /* ─── Hero section ─── */
    .hero {
      position: relative;
      height: 100vh;
      background: url('https://neurosciencenews.com/files/2023/10/cat-dog-culture-affection-neuroscience.jpg')
                  center/cover no-repeat;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .hero::before {
      content: '';
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.4);
    }
    .hero-content {
      position: relative;
      text-align: center;
      color: #fff;
      max-width: 700px;
      padding: 0 1rem;
    }
    .hero-content h1 {
      font-size: 2.8rem;
      font-weight: 600;
      margin-bottom: 1rem;
    }
    .hero-content p {
      font-size: 1rem;
      line-height: 1.5;
      margin-bottom: 2rem;
    }
    .hero-content a.btn {
      display: inline-block;
      background: #26c1a8;
      color: #fff;
      text-decoration: none;
      padding: 14px 34px;
      font-size: 1rem;
      font-weight: 600;
      border-radius: 12px;
      transition: .3s background;
    }
    .hero-content a.btn:hover {
      background: #1ea893;
    }
  </style>
</head>
<body>
  <?php include_once 'app/views/partials/nav.php'; ?>

  <section class="hero">
    <div class="hero-content">
      <h1>Welcome to Your Paw-tastic Adventure, <?=htmlspecialchars($data['user'])?>!</h1>
      <div style="white-space: pre-wrap; font-family: 'Segoe UI', sans-serif; font-size: 1.1rem; margin-bottom: 3rem;">
Your one-stop haven for furry friends, wagging tails, and purring hearts.
Looking for the perfect companion? Whether it’s playful pups, cuddly kittens, or all the toys and treats in between — we’re here to help you find joy, love, and loyalty wrapped in fur.
Adopt. Shop. Love.

🦴 Browse our adorable buddies
🛍️ Explore must-have pet goodies
💗 Bring home happiness today!
</div>
      <a href="<?=BASE_URL?>/Pet/index" class="btn">Start Your Paw-venture</a>
    </div>
  </section>
</body>
</html>


===== FILE: app\views\vaccination\index.php =====
<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>Vaccination Reminders • PawCare</title>
<link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Quicksand',sans-serif;background:#f0faf6;padding:40px}
.container{max-width:1050px;margin:90px auto 30px}
h1{font-size:2rem;font-weight:600;color:#41403e;text-align:center;margin-bottom:8px}
.sub{color:#6f7b78;text-align:center;margin-bottom:22px;font-size:.95rem}

.grid{display:grid;grid-template-columns:1fr;gap:18px}
.card{background:#fff;border-radius:16px;box-shadow:0 8px 18px rgba(0,0,0,.08);padding:20px}

label{display:block;font-weight:700;color:#41403e;margin:10px 0 6px;font-size:.95rem}
input,textarea{width:100%;padding:.75rem 1rem;border:2px solid #e9e7e6;border-radius:10px}
input:focus,textarea:focus{border-color:#26c1a8;outline:none}
.row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
button{margin-top:14px;background:#26c1a8;color:#fff;border:none;padding:.9rem 1.2rem;font-weight:700;border-radius:10px;cursor:pointer}
button:hover{background:#1ea893}

.table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{padding:12px 14px;text-align:left;font-size:.93rem}
th{background:#26c1a8;color:#fff}
tr:nth-child(even){background:#fafafa}

.badge{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;font-size:.78rem}
.scheduled{background:#e7f8f4;border:1px solid #bfece1;color:#1b907d}
.done{background:#e8eafc;border:1px solid #c7cbff;color:#343a8b}
.missed{background:#ffe6e6;border:1px solid #ffb2b2;color:#9c2a2a}
.soon{background:#fff3d6;border:1px solid #f5d48a;color:#9b6b00}

.act a{display:inline-block;margin-right:8px;text-decoration:none;font-weight:700}
a.green{color:#26c1a8}a.green:hover{text-decoration:underline}
a.red{color:#ff6b6b}a.red:hover{text-decoration:underline}
</style></head><body>
<?php include_once 'app/views/partials/nav.php'; ?>

<div class="container">
  <h1>Vaccination Reminders</h1>
  <div class="sub">Add your pet’s vaccinations and we’ll keep them visible on your profile when due soon.</div>

  <div class="grid">
    <div class="card">
      <form method="POST" action="<?=BASE_URL?>/Vaccination/index">
        <div class="row">
          <div>
            <label>Pet Name *</label>
            <input type="text" name="pet_name" required>
          </div>
          <div>
            <label>Vaccine *</label>
            <input type="text" name="vaccine" placeholder="e.g., Rabies, DHPP" required>
          </div>
        </div>

        <div class="row">
          <div>
            <label>Dose / Shot #</label>
            <input type="text" name="dose" placeholder="e.g., Booster #2">
          </div>
          <div>
            <label>Due Date *</label>
            <input type="date" name="due_date" required>
          </div>
        </div>

        <label>Notes</label>
        <textarea name="notes" rows="3" placeholder="Any details your vet gave you"></textarea>

        <button type="submit">Save Vaccination</button>
      </form>
    </div>

    <div class="card">
      <?php if(empty($list)): ?>
        <div style="color:#60706d">No vaccinations yet. Add your first reminder on the left.</div>
      <?php else: ?>
      <table class="table">
        <thead>
          <tr>
            <th style="width:160px">Due</th>
            <th>Pet</th>
            <th>Vaccine</th>
            <th style="width:110px">Status</th>
            <th style="width:22%">Actions</th>
          </tr>
        </thead>
        <tbody>
        <?php
          $today = new DateTime('today');
          foreach($list as $r):
              $due = new DateTime($r['due_date']);
              $status = $r['status'];

              // mark missed (visual only) if still scheduled but date passed
              $badge = $status;
              if ($status==='scheduled' && $due < $today) $badge = 'missed';

              // within next 7 days = soon
              $soon = ($status!=='done' && $due >= $today && $due <= (new DateTime('+7 days')));
        ?>
          <tr>
            <td><?=date('M d, Y', strtotime($r['due_date']))?></td>
            <td><?=htmlspecialchars($r['pet_name'])?></td>
            <td>
              <?=htmlspecialchars($r['vaccine'])?>
              <?php if($r['dose']): ?> (<?=htmlspecialchars($r['dose'])?>)<?php endif; ?>
              <?php if($soon): ?> <span class="badge soon">Soon</span><?php endif; ?>
            </td>
            <td><span class="badge <?=$badge?>"><?=ucfirst($badge)?></span></td>
            <td class="act">
              <?php if($r['status']!=='done'): ?>
                <a class="green" href="<?=BASE_URL?>/Vaccination/done?id=<?=$r['id']?>">Mark Done</a>
              <?php else: ?>
                <a class="green" href="<?=BASE_URL?>/Vaccination/schedule?id=<?=$r['id']?>">Re-schedule</a>
              <?php endif; ?>
              <a class="red" href="<?=BASE_URL?>/Vaccination/delete?id=<?=$r['id']?>" onclick="return confirm('Delete this record?')">Delete</a>
            </td>
          </tr>
        <?php endforeach; ?>
        </tbody>
      </table>
      <?php endif; ?>
    </div>
  </div>
</div>
</body></html>


===== FILE: core\Controller.php =====
<?php
class Controller
{
    /* load a model */
    public function model($model)
    {
        require_once 'app/models/' . $model . '.php';
        return new $model();
    }

    /* load a view and make $data keys available as variables */
    public function view($view, $data = [])
    {
        extract($data);                           // ⭐ makes $prod, $products, etc.
        require 'app/views/' . $view . '.php';
    }
}


===== FILE: core\Database.php =====
<?php
class Database {
    protected $pdo;

    public function __construct() {
        try {
            $this->pdo = new PDO("mysql:host=localhost;dbname=pawcare_db", "root", "");
        } catch (PDOException $e) {
            die($e->getMessage());
        }
    }
}

